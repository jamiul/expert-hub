var Fs=(B,de)=>()=>(de||B((de={exports:{}}).exports,de),de.exports);var Gs=Fs((Bt,pn)=>{/*!
 * FilePond 4.30.4
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */(function(B,de){typeof Bt=="object"&&typeof pn<"u"?de(Bt):typeof define=="function"&&define.amd?define(["exports"],de):(B=B||self,de(B.FilePond={}))})(globalThis,function(B){var de=function(e){return e instanceof HTMLElement},En=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],n=Object.assign({},e),i=[],o=[],s=function(){return Object.assign({},n)},u=function(){var p=[].concat(i);return i.length=0,p},l=function(){var p=[].concat(o);o.length=0,p.forEach(function(_){var S=_.type,P=_.data;c(S,P)})},c=function(p,_,S){if(S&&!document.hidden){o.push({type:p,data:_});return}I[p]&&I[p](_),i.push({type:p,data:_})},d=function(p){for(var _,S=arguments.length,P=new Array(S>1?S-1:0),R=1;R<S;R++)P[R-1]=arguments[R];return E[p]?(_=E)[p].apply(_,P):null},f={getState:s,processActionQueue:u,processDispatchQueue:l,dispatch:c,query:d},E={};t.forEach(function(T){E=Object.assign({},T(n),{},E)});var I={};return r.forEach(function(T){I=Object.assign({},T(c,d,n),{},I)}),f},gn=function(e,t,r){if(typeof r=="function"){e[t]=r;return}Object.defineProperty(e,t,Object.assign({},r))},X=function(e,t){for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])},me=function(e){var t={};return X(e,function(r){gn(t,r,e[r])}),t},k=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(r===null)return e.getAttribute(t)||e.hasAttribute(t);e.setAttribute(t,r)},mn="http://www.w3.org/2000/svg",In=["svg","path"],Ut=function(e){return In.includes(e)},We=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};typeof t=="object"&&(r=t,t=null);var n=Ut(e)?document.createElementNS(mn,e):document.createElement(e);return t&&(Ut(e)?k(n,"class",t):n.className=t),X(r,function(i,o){k(n,i,o)}),n},Tn=function(e){return function(t,r){typeof r<"u"&&e.children[r]?e.insertBefore(t,e.children[r]):e.appendChild(t)}},_n=function(e,t){return function(r,n){return typeof n<"u"?t.splice(n,0,r):t.push(r),r}},Rn=function(e,t){return function(r){return t.splice(t.indexOf(r),1),r.element.parentNode&&e.removeChild(r.element),r}},hn=function(){return typeof window<"u"&&typeof window.document<"u"}(),Vt=function(){return hn},On=Vt()?We("svg"):{},Dn="children"in On?function(a){return a.children.length}:function(a){return a.childNodes.length},qt=function(e,t,r,n){var i=r[0]||e.left,o=r[1]||e.top,s=i+e.width,u=o+e.height*(n[1]||1),l={element:Object.assign({},e),inner:{left:e.left,top:e.top,right:e.right,bottom:e.bottom},outer:{left:i,top:o,right:s,bottom:u}};return t.filter(function(c){return!c.isRectIgnored()}).map(function(c){return c.rect}).forEach(function(c){xt(l.inner,Object.assign({},c.inner)),xt(l.outer,Object.assign({},c.outer))}),Yt(l.inner),l.outer.bottom+=l.element.marginBottom,l.outer.right+=l.element.marginRight,Yt(l.outer),l},xt=function(e,t){t.top+=e.top,t.right+=e.left,t.bottom+=e.top,t.left+=e.left,t.bottom>e.bottom&&(e.bottom=t.bottom),t.right>e.right&&(e.right=t.right)},Yt=function(e){e.width=e.right-e.left,e.height=e.bottom-e.top},_e=function(e){return typeof e=="number"},Sn=function(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.001;return Math.abs(e-t)<n&&Math.abs(r)<n},An=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.stiffness,r=t===void 0?.5:t,n=e.damping,i=n===void 0?.75:n,o=e.mass,s=o===void 0?10:o,u=null,l=null,c=0,d=!1,f=function(p,_){if(!d){if(!(_e(u)&&_e(l))){d=!0,c=0;return}var S=-(l-u)*r;c+=S/s,l+=c,c*=i,Sn(l,u,c)||_?(l=u,c=0,d=!0,I.onupdate(l),I.oncomplete(l)):I.onupdate(l)}},E=function(p){if(_e(p)&&!_e(l)&&(l=p),u===null&&(u=p,l=p),u=p,l===u||typeof u>"u"){d=!0,c=0,I.onupdate(l),I.oncomplete(l);return}d=!1},I=me({interpolate:f,target:{set:E,get:function(){return u}},resting:{get:function(){return d}},onupdate:function(p){},oncomplete:function(p){}});return I},yn=function(e){return e<.5?2*e*e:-1+(4-2*e)*e},Pn=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.duration,r=t===void 0?500:t,n=e.easing,i=n===void 0?yn:n,o=e.delay,s=o===void 0?0:o,u=null,l,c,d=!0,f=!1,E=null,I=function(_,S){d||E===null||(u===null&&(u=_),!(_-u<s)&&(l=_-u-s,l>=r||S?(l=1,c=f?0:1,T.onupdate(c*E),T.oncomplete(c*E),d=!0):(c=l/r,T.onupdate((l>=0?i(f?1-c:c):0)*E))))},T=me({interpolate:I,target:{get:function(){return f?0:E},set:function(_){if(E===null){E=_,T.onupdate(_),T.oncomplete(_);return}_<E?(E=1,f=!0):(f=!1,E=_),d=!1,u=null}},resting:{get:function(){return d}},onupdate:function(_){},oncomplete:function(_){}});return T},Ht={spring:An,tween:Pn},bn=function(e,t,r){var n=e[t]&&typeof e[t][r]=="object"?e[t][r]:e[t]||e,i=typeof n=="string"?n:n.type,o=typeof n=="object"?Object.assign({},n):{};return Ht[i]?Ht[i](o):null},lt=function(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;t=Array.isArray(t)?t:[t],t.forEach(function(i){e.forEach(function(o){var s=o,u=function(){return r[o]},l=function(d){return r[o]=d};typeof o=="object"&&(s=o.key,u=o.getter||u,l=o.setter||l),!(i[s]&&!n)&&(i[s]={get:u,set:l})})})},Ln=function(e){var t=e.mixinConfig,r=e.viewProps,n=e.viewInternalAPI,i=e.viewExternalAPI,o=Object.assign({},r),s=[];return X(t,function(u,l){var c=bn(l);if(c){c.onupdate=function(f){r[u]=f},c.target=o[u];var d={key:u,setter:function(E){c.target!==E&&(c.target=E)},getter:function(){return r[u]}};lt([d],[n,i],r,!0),s.push(c)}}),{write:function(l){var c=document.hidden,d=!0;return s.forEach(function(f){f.resting||(d=!1),f.interpolate(l,c)}),d},destroy:function(){}}},Mn=function(e){return function(t,r){e.addEventListener(t,r)}},Cn=function(e){return function(t,r){e.removeEventListener(t,r)}},wn=function(e){e.mixinConfig,e.viewProps,e.viewInternalAPI;var t=e.viewExternalAPI;e.viewState;var r=e.view,n=[],i=Mn(r.element),o=Cn(r.element);return t.on=function(s,u){n.push({type:s,fn:u}),i(s,u)},t.off=function(s,u){n.splice(n.findIndex(function(l){return l.type===s&&l.fn===u}),1),o(s,u)},{write:function(){return!0},destroy:function(){n.forEach(function(u){o(u.type,u.fn)})}}},Nn=function(e){var t=e.mixinConfig,r=e.viewProps,n=e.viewExternalAPI;lt(t,n,r)},ee=function(e){return e!=null},Fn={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},Gn=function(e){var t=e.mixinConfig,r=e.viewProps,n=e.viewInternalAPI,i=e.viewExternalAPI,o=e.view,s=Object.assign({},r),u={};lt(t,[n,i],r);var l=function(){return[r.translateX||0,r.translateY||0]},c=function(){return[r.scaleX||0,r.scaleY||0]},d=function(){return o.rect?qt(o.rect,o.childViews,l(),c()):null};return n.rect={get:d},i.rect={get:d},t.forEach(function(f){r[f]=typeof s[f]>"u"?Fn[f]:s[f]}),{write:function(){if(Bn(u,r))return Un(o.element,r),Object.assign(u,Object.assign({},r)),!0},destroy:function(){}}},Bn=function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!0;for(var r in t)if(t[r]!==e[r])return!0;return!1},Un=function(e,t){var r=t.opacity,n=t.perspective,i=t.translateX,o=t.translateY,s=t.scaleX,u=t.scaleY,l=t.rotateX,c=t.rotateY,d=t.rotateZ,f=t.originX,E=t.originY,I=t.width,T=t.height,p="",_="";(ee(f)||ee(E))&&(_+="transform-origin: "+(f||0)+"px "+(E||0)+"px;"),ee(n)&&(p+="perspective("+n+"px) "),(ee(i)||ee(o))&&(p+="translate3d("+(i||0)+"px, "+(o||0)+"px, 0) "),(ee(s)||ee(u))&&(p+="scale3d("+(ee(s)?s:1)+", "+(ee(u)?u:1)+", 1) "),ee(d)&&(p+="rotateZ("+d+"rad) "),ee(l)&&(p+="rotateX("+l+"rad) "),ee(c)&&(p+="rotateY("+c+"rad) "),p.length&&(_+="transform:"+p+";"),ee(r)&&(_+="opacity:"+r+";",r===0&&(_+="visibility:hidden;"),r<1&&(_+="pointer-events:none;")),ee(T)&&(_+="height:"+T+"px;"),ee(I)&&(_+="width:"+I+"px;");var S=e.elementCurrentStyle||"";(_.length!==S.length||_!==S)&&(e.style.cssText=_,e.elementCurrentStyle=_)},Vn={styles:Gn,listeners:wn,animations:Ln,apis:Nn},Wt=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t.layoutCalculated||(e.paddingTop=parseInt(r.paddingTop,10)||0,e.marginTop=parseInt(r.marginTop,10)||0,e.marginRight=parseInt(r.marginRight,10)||0,e.marginBottom=parseInt(r.marginBottom,10)||0,e.marginLeft=parseInt(r.marginLeft,10)||0,t.layoutCalculated=!0),e.left=t.offsetLeft||0,e.top=t.offsetTop||0,e.width=t.offsetWidth||0,e.height=t.offsetHeight||0,e.right=e.left+e.width,e.bottom=e.top+e.height,e.scrollTop=t.scrollTop,e.hidden=t.offsetParent===null,e},K=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.tag,r=t===void 0?"div":t,n=e.name,i=n===void 0?null:n,o=e.attributes,s=o===void 0?{}:o,u=e.read,l=u===void 0?function(){}:u,c=e.write,d=c===void 0?function(){}:c,f=e.create,E=f===void 0?function(){}:f,I=e.destroy,T=I===void 0?function(){}:I,p=e.filterFrameActionsForChild,_=p===void 0?function(O,A){return A}:p,S=e.didCreateView,P=S===void 0?function(){}:S,R=e.didWriteView,F=R===void 0?function(){}:R,h=e.ignoreRect,H=h===void 0?!1:h,W=e.ignoreRectUpdate,D=W===void 0?!1:W,b=e.mixins,L=b===void 0?[]:b;return function(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},M=We(r,"filepond--"+i,s),j=window.getComputedStyle(M,null),Y=Wt(),C=null,m=!1,v=[],y=[],w={},G={},V=[d],U=[l],x=[T],Ge=function(){return M},He=function(){return v.concat()},ys=function(){return w},Ps=function(q){return function(Ee,ge){return Ee(q,ge)}},cn=function(){return C||(C=qt(Y,v,[0,0],[1,1]),C)},bs=function(){return j},Ls=function(){C=null,v.forEach(function(ge){return ge._read()});var q=!(D&&Y.width&&Y.height);q&&Wt(Y,M,j);var Ee={root:Te,props:A,rect:Y};U.forEach(function(ge){return ge(Ee)})},Ms=function(q,Ee,ge){var Be=Ee.length===0;return V.forEach(function(ie){var Pe=ie({props:A,root:Te,actions:Ee,timestamp:q,shouldOptimize:ge});Pe===!1&&(Be=!1)}),y.forEach(function(ie){var Pe=ie.write(q);Pe===!1&&(Be=!1)}),v.filter(function(ie){return!!ie.element.parentNode}).forEach(function(ie){var Pe=ie._write(q,_(ie,Ee),ge);Pe||(Be=!1)}),v.forEach(function(ie,Pe){ie.element.parentNode||(Te.appendChild(ie.element,Pe),ie._read(),ie._write(q,_(ie,Ee),ge),Be=!1)}),m=Be,F({props:A,root:Te,actions:Ee,timestamp:q}),Be},Cs=function(){y.forEach(function(q){return q.destroy()}),x.forEach(function(q){q({root:Te,props:A})}),v.forEach(function(q){return q._destroy()})},fn={element:{get:Ge},style:{get:bs},childViews:{get:He}},dn=Object.assign({},fn,{rect:{get:cn},ref:{get:ys},is:function(q){return i===q},appendChild:Tn(M),createChildView:Ps(O),linkView:function(q){return v.push(q),q},unlinkView:function(q){v.splice(v.indexOf(q),1)},appendChildView:_n(M,v),removeChildView:Rn(M,v),registerWriter:function(q){return V.push(q)},registerReader:function(q){return U.push(q)},registerDestroyer:function(q){return x.push(q)},invalidateLayout:function(){return M.layoutCalculated=!1},dispatch:O.dispatch,query:O.query}),vn={element:{get:Ge},childViews:{get:He},rect:{get:cn},resting:{get:function(){return m}},isRectIgnored:function(){return H},_read:Ls,_write:Ms,_destroy:Cs},ws=Object.assign({},fn,{rect:{get:function(){return Y}}});Object.keys(L).sort(function(z,q){return z==="styles"?1:q==="styles"?-1:0}).forEach(function(z){var q=Vn[z]({mixinConfig:L[z],viewProps:A,viewState:G,viewInternalAPI:dn,viewExternalAPI:vn,view:me(ws)});q&&y.push(q)});var Te=me(dn);E({root:Te,props:A});var Ns=Dn(M);return v.forEach(function(z,q){Te.appendChild(z.element,Ns+q)}),P(Te),me(vn)}},qn=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:60,n="__framePainter";if(window[n]){window[n].readers.push(e),window[n].writers.push(t);return}window[n]={readers:[e],writers:[t]};var i=window[n],o=1e3/r,s=null,u=null,l=null,c=null,d=function(){document.hidden?(l=function(){return window.setTimeout(function(){return f(performance.now())},o)},c=function(){return window.clearTimeout(u)}):(l=function(){return window.requestAnimationFrame(f)},c=function(){return window.cancelAnimationFrame(u)})};document.addEventListener("visibilitychange",function(){c&&c(),d(),f(performance.now())});var f=function E(I){u=l(E),s||(s=I);var T=I-s;T<=o||(s=I-T%o,i.readers.forEach(function(p){return p()}),i.writers.forEach(function(p){return p(I)}))};return d(),f(performance.now()),{pause:function(){c(u)}}},te=function(e,t){return function(r){var n=r.root,i=r.props,o=r.actions,s=o===void 0?[]:o,u=r.timestamp,l=r.shouldOptimize;s.filter(function(c){return e[c.type]}).forEach(function(c){return e[c.type]({root:n,props:i,action:c.data,timestamp:u,shouldOptimize:l})}),t&&t({root:n,props:i,actions:s,timestamp:u,shouldOptimize:l})}},jt=function(e,t){return t.parentNode.insertBefore(e,t)},zt=function(e,t){return t.parentNode.insertBefore(e,t.nextSibling)},je=function(e){return Array.isArray(e)},ve=function(e){return e==null},xn=function(e){return e.trim()},ze=function(e){return""+e},Yn=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",";return ve(e)?[]:je(e)?e:ze(e).split(t).map(xn).filter(function(r){return r.length})},Xt=function(e){return typeof e=="boolean"},$t=function(e){return Xt(e)?e:e==="true"},re=function(e){return typeof e=="string"},Qt=function(e){return _e(e)?e:re(e)?ze(e).replace(/[a-z]+/gi,""):0},Xe=function(e){return parseInt(Qt(e),10)},kt=function(e){return parseFloat(Qt(e))},be=function(e){return _e(e)&&isFinite(e)&&Math.floor(e)===e},Kt=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;if(be(e))return e;var r=ze(e).trim();return/MB$/i.test(r)?(r=r.replace(/MB$i/,"").trim(),Xe(r)*t*t):/KB/i.test(r)?(r=r.replace(/KB$i/,"").trim(),Xe(r)*t):Xe(r)},Re=function(e){return typeof e=="function"},Hn=function(e){for(var t=self,r=e.split("."),n=null;n=r.shift();)if(t=t[n],!t)return null;return t},Zt={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},Wn=function(e){var t={};return t.url=re(e)?e:e.url||"",t.timeout=e.timeout?parseInt(e.timeout,10):0,t.headers=e.headers?e.headers:{},X(Zt,function(r){t[r]=jn(r,e[r],Zt[r],t.timeout,t.headers)}),t.process=e.process||re(e)||e.url?t.process:null,t.remove=e.remove||null,delete t.headers,t},jn=function(e,t,r,n,i){if(t===null)return null;if(typeof t=="function")return t;var o={url:r==="GET"||r==="PATCH"?"?"+e+"=":"",method:r,headers:i,withCredentials:!1,timeout:n,onload:null,ondata:null,onerror:null};if(re(t))return o.url=t,o;if(Object.assign(o,t),re(o.headers)){var s=o.headers.split(/:(.+)/);o.headers={header:s[0],value:s[1]}}return o.withCredentials=$t(o.withCredentials),o},zn=function(e){return Wn(e)},Xn=function(e){return e===null},J=function(e){return typeof e=="object"&&e!==null},$n=function(e){return J(e)&&re(e.url)&&J(e.process)&&J(e.revert)&&J(e.restore)&&J(e.fetch)},ct=function(e){return je(e)?"array":Xn(e)?"null":be(e)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(e)?"bytes":$n(e)?"api":typeof e},Qn=function(e){return e.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",')},kn={array:Yn,boolean:$t,int:function(e){return ct(e)==="bytes"?Kt(e):Xe(e)},number:kt,float:kt,bytes:Kt,string:function(e){return Re(e)?e:ze(e)},function:function(e){return Hn(e)},serverapi:zn,object:function(e){try{return JSON.parse(Qn(e))}catch{return null}}},Kn=function(e,t){return kn[t](e)},Jt=function(e,t,r){if(e===t)return e;var n=ct(e);if(n!==r){var i=Kn(e,r);if(n=ct(i),i===null)throw'Trying to assign value with incorrect type to "'+option+'", allowed type: "'+r+'"';e=i}return e},Zn=function(e,t){var r=e;return{enumerable:!0,get:function(){return r},set:function(i){r=Jt(i,e,t)}}},Jn=function(e){var t={};return X(e,function(r){var n=e[r];t[r]=Zn(n[0],n[1])}),me(t)},ei=function(e){return{items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:Jn(e)}},$e=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"-";return e.split(/(?=[A-Z])/).map(function(r){return r.toLowerCase()}).join(t)},ti=function(e,t){var r={};return X(t,function(n){r[n]={get:function(){return e.getState().options[n]},set:function(o){e.dispatch("SET_"+$e(n,"_").toUpperCase(),{value:o})}}}),r},ri=function(e){return function(t,r,n){var i={};return X(e,function(o){var s=$e(o,"_").toUpperCase();i["SET_"+s]=function(u){try{n.options[o]=u.value}catch{}t("DID_SET_"+s,{value:n.options[o]})}}),i}},ni=function(e){return function(t){var r={};return X(e,function(n){r["GET_"+$e(n,"_").toUpperCase()]=function(i){return t.options[n]}}),r}},oe={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5},ft=function(){return Math.random().toString(36).substring(2,11)};function ii(a,e){if(a==null)return{};var t={},r=Object.keys(a),n,i;for(i=0;i<r.length;i++)n=r[i],!(e.indexOf(n)>=0)&&(t[n]=a[n]);return t}function ai(a,e){if(a==null)return{};var t=ii(a,e),r,n;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(a);for(n=0;n<i.length;n++)r=i[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(t[r]=a[r])}return t}function Qe(a){return oi(a)||si(a)||ui()}function oi(a){if(Array.isArray(a)){for(var e=0,t=new Array(a.length);e<a.length;e++)t[e]=a[e];return t}}function si(a){if(Symbol.iterator in Object(a)||Object.prototype.toString.call(a)==="[object Arguments]")return Array.from(a)}function ui(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var dt=function(e,t){return e.splice(t,1)},li=function(e,t){t?e():document.hidden?Promise.resolve(1).then(e):setTimeout(e,0)},ke=function(){var e=[],t=function(i,o){dt(e,e.findIndex(function(s){return s.event===i&&(s.cb===o||!o)}))},r=function(i,o,s){e.filter(function(u){return u.event===i}).map(function(u){return u.cb}).forEach(function(u){return li(function(){return u.apply(void 0,Qe(o))},s)})};return{fireSync:function(i){for(var o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];r(i,s,!0)},fire:function(i){for(var o=arguments.length,s=new Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];r(i,s,!1)},on:function(i,o){e.push({event:i,cb:o})},onOnce:function(i,o){e.push({event:i,cb:function(){t(i,o),o.apply(void 0,arguments)}})},off:t}},er=function(e,t,r){Object.getOwnPropertyNames(e).filter(function(n){return!r.includes(n)}).forEach(function(n){return Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})},ci=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"],ne=function(e){var t={};return er(e,t,ci),t},fi=function(e){e.forEach(function(t,r){t.released&&dt(e,r)})},N={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},Z={INPUT:1,LIMBO:2,LOCAL:3},tr=function(e){return/[^0-9]+/.exec(e)},rr=function(){return tr(1.1.toLocaleString())[0]},di=function(){var e=rr(),t=1e3.toLocaleString(),r=1e3.toString();return t!==r?tr(t)[0]:e==="."?",":"."},g={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},vt=[],le=function(e,t,r){return new Promise(function(n,i){var o=vt.filter(function(u){return u.key===e}).map(function(u){return u.cb});if(o.length===0){n(t);return}var s=o.shift();o.reduce(function(u,l){return u.then(function(c){return l(c,r)})},s(t,r)).then(function(u){return n(u)}).catch(function(u){return i(u)})})},he=function(e,t,r){return vt.filter(function(n){return n.key===e}).map(function(n){return n.cb(t,r)})},vi=function(e,t){return vt.push({key:e,cb:t})},pi=function(e){return Object.assign(Le,e)},Ke=function(){return Object.assign({},Le)},Ei=function(e){X(e,function(t,r){Le[t]&&(Le[t][0]=Jt(r,Le[t][0],Le[t][1]))})},Le={id:[null,g.STRING],name:["filepond",g.STRING],disabled:[!1,g.BOOLEAN],className:[null,g.STRING],required:[!1,g.BOOLEAN],captureMethod:[null,g.STRING],allowSyncAcceptAttribute:[!0,g.BOOLEAN],allowDrop:[!0,g.BOOLEAN],allowBrowse:[!0,g.BOOLEAN],allowPaste:[!0,g.BOOLEAN],allowMultiple:[!1,g.BOOLEAN],allowReplace:[!0,g.BOOLEAN],allowRevert:[!0,g.BOOLEAN],allowRemove:[!0,g.BOOLEAN],allowProcess:[!0,g.BOOLEAN],allowReorder:[!1,g.BOOLEAN],allowDirectoriesOnly:[!1,g.BOOLEAN],storeAsFile:[!1,g.BOOLEAN],forceRevert:[!1,g.BOOLEAN],maxFiles:[null,g.INT],checkValidity:[!1,g.BOOLEAN],itemInsertLocationFreedom:[!0,g.BOOLEAN],itemInsertLocation:["before",g.STRING],itemInsertInterval:[75,g.INT],dropOnPage:[!1,g.BOOLEAN],dropOnElement:[!0,g.BOOLEAN],dropValidation:[!1,g.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],g.ARRAY],instantUpload:[!0,g.BOOLEAN],maxParallelUploads:[2,g.INT],allowMinimumUploadDuration:[!0,g.BOOLEAN],chunkUploads:[!1,g.BOOLEAN],chunkForce:[!1,g.BOOLEAN],chunkSize:[5e6,g.INT],chunkRetryDelays:[[500,1e3,3e3],g.ARRAY],server:[null,g.SERVER_API],fileSizeBase:[1e3,g.INT],labelFileSizeBytes:["bytes",g.STRING],labelFileSizeKilobytes:["KB",g.STRING],labelFileSizeMegabytes:["MB",g.STRING],labelFileSizeGigabytes:["GB",g.STRING],labelDecimalSeparator:[rr(),g.STRING],labelThousandsSeparator:[di(),g.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',g.STRING],labelInvalidField:["Field contains invalid files",g.STRING],labelFileWaitingForSize:["Waiting for size",g.STRING],labelFileSizeNotAvailable:["Size not available",g.STRING],labelFileCountSingular:["file in list",g.STRING],labelFileCountPlural:["files in list",g.STRING],labelFileLoading:["Loading",g.STRING],labelFileAdded:["Added",g.STRING],labelFileLoadError:["Error during load",g.STRING],labelFileRemoved:["Removed",g.STRING],labelFileRemoveError:["Error during remove",g.STRING],labelFileProcessing:["Uploading",g.STRING],labelFileProcessingComplete:["Upload complete",g.STRING],labelFileProcessingAborted:["Upload cancelled",g.STRING],labelFileProcessingError:["Error during upload",g.STRING],labelFileProcessingRevertError:["Error during revert",g.STRING],labelTapToCancel:["tap to cancel",g.STRING],labelTapToRetry:["tap to retry",g.STRING],labelTapToUndo:["tap to undo",g.STRING],labelButtonRemoveItem:["Remove",g.STRING],labelButtonAbortItemLoad:["Abort",g.STRING],labelButtonRetryItemLoad:["Retry",g.STRING],labelButtonAbortItemProcessing:["Cancel",g.STRING],labelButtonUndoItemProcessing:["Undo",g.STRING],labelButtonRetryItemProcessing:["Retry",g.STRING],labelButtonProcessItem:["Upload",g.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',g.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',g.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',g.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',g.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',g.STRING],oninit:[null,g.FUNCTION],onwarning:[null,g.FUNCTION],onerror:[null,g.FUNCTION],onactivatefile:[null,g.FUNCTION],oninitfile:[null,g.FUNCTION],onaddfilestart:[null,g.FUNCTION],onaddfileprogress:[null,g.FUNCTION],onaddfile:[null,g.FUNCTION],onprocessfilestart:[null,g.FUNCTION],onprocessfileprogress:[null,g.FUNCTION],onprocessfileabort:[null,g.FUNCTION],onprocessfilerevert:[null,g.FUNCTION],onprocessfile:[null,g.FUNCTION],onprocessfiles:[null,g.FUNCTION],onremovefile:[null,g.FUNCTION],onpreparefile:[null,g.FUNCTION],onupdatefiles:[null,g.FUNCTION],onreorderfiles:[null,g.FUNCTION],beforeDropFile:[null,g.FUNCTION],beforeAddFile:[null,g.FUNCTION],beforeRemoveFile:[null,g.FUNCTION],beforePrepareFile:[null,g.FUNCTION],stylePanelLayout:[null,g.STRING],stylePanelAspectRatio:[null,g.STRING],styleItemPanelAspectRatio:[null,g.STRING],styleButtonRemoveItemPosition:["left",g.STRING],styleButtonProcessItemPosition:["right",g.STRING],styleLoadIndicatorPosition:["right",g.STRING],styleProgressIndicatorPosition:["right",g.STRING],styleButtonRemoveItemAlign:[!1,g.BOOLEAN],files:[[],g.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],g.ARRAY]},Oe=function(e,t){return ve(t)?e[0]||null:be(t)?e[t]||null:(typeof t=="object"&&(t=t.id),e.find(function(r){return r.id===t})||null)},nr=function(e){if(ve(e))return e;if(/:/.test(e)){var t=e.split(":");return t[1]/t[0]}return parseFloat(e)},ce=function(e){return e.filter(function(t){return!t.archived})},Me={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4},Ze=null,gi=function(){if(Ze===null)try{var e=new DataTransfer;e.items.add(new File(["hello world"],"This_Works.txt"));var t=document.createElement("input");t.setAttribute("type","file"),t.files=e.files,Ze=t.files.length===1}catch{Ze=!1}return Ze},mi=[N.LOAD_ERROR,N.PROCESSING_ERROR,N.PROCESSING_REVERT_ERROR],Ii=[N.LOADING,N.PROCESSING,N.PROCESSING_QUEUED,N.INIT],Ti=[N.PROCESSING_COMPLETE],_i=function(e){return mi.includes(e.status)},Ri=function(e){return Ii.includes(e.status)},hi=function(e){return Ti.includes(e.status)},ir=function(e){return J(e.options.server)&&(J(e.options.server.process)||Re(e.options.server.process))},Oi=function(e){return{GET_STATUS:function(){var r=ce(e.items),n=Me.EMPTY,i=Me.ERROR,o=Me.BUSY,s=Me.IDLE,u=Me.READY;return r.length===0?n:r.some(_i)?i:r.some(Ri)?o:r.some(hi)?u:s},GET_ITEM:function(r){return Oe(e.items,r)},GET_ACTIVE_ITEM:function(r){return Oe(ce(e.items),r)},GET_ACTIVE_ITEMS:function(){return ce(e.items)},GET_ITEMS:function(){return e.items},GET_ITEM_NAME:function(r){var n=Oe(e.items,r);return n?n.filename:null},GET_ITEM_SIZE:function(r){var n=Oe(e.items,r);return n?n.fileSize:null},GET_STYLES:function(){return Object.keys(e.options).filter(function(r){return/^style/.test(r)}).map(function(r){return{name:r,value:e.options[r]}})},GET_PANEL_ASPECT_RATIO:function(){var r=/circle/.test(e.options.stylePanelLayout),n=r?1:nr(e.options.stylePanelAspectRatio);return n},GET_ITEM_PANEL_ASPECT_RATIO:function(){return e.options.styleItemPanelAspectRatio},GET_ITEMS_BY_STATUS:function(r){return ce(e.items).filter(function(n){return n.status===r})},GET_TOTAL_ITEMS:function(){return ce(e.items).length},SHOULD_UPDATE_FILE_INPUT:function(){return e.options.storeAsFile&&gi()&&!ir(e)},IS_ASYNC:function(){return ir(e)},GET_FILE_SIZE_LABELS:function(r){return{labelBytes:r("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:r("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:r("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:r("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0}}}},Di=function(e){var t=ce(e.items).length;if(!e.options.allowMultiple)return t===0;var r=e.options.maxFiles;return r===null||t<r},ar=function(e,t,r){return Math.max(Math.min(r,e),t)},Si=function(e,t,r){return e.splice(t,0,r)},Ai=function(e,t,r){return ve(t)?null:typeof r>"u"?(e.push(t),t):(r=ar(r,0,e.length),Si(e,r,t),t)},pt=function(e){return/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(e)},Ue=function(e){return e.split("/").pop().split("?").shift()},Je=function(e){return e.split(".").pop()},yi=function(e){if(typeof e!="string")return"";var t=e.split("/").pop();return/svg/.test(t)?"svg":/zip|compressed/.test(t)?"zip":/plain/.test(t)?"txt":/msword/.test(t)?"doc":/[a-z]+/.test(t)?t==="jpeg"?"jpg":t:""},Ve=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return(t+e).slice(-t.length)},or=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Date;return e.getFullYear()+"-"+Ve(e.getMonth()+1,"00")+"-"+Ve(e.getDate(),"00")+"_"+Ve(e.getHours(),"00")+"-"+Ve(e.getMinutes(),"00")+"-"+Ve(e.getSeconds(),"00")},Ce=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=typeof r=="string"?e.slice(0,e.size,r):e.slice(0,e.size,e.type);return i.lastModifiedDate=new Date,e._relativePath&&(i._relativePath=e._relativePath),re(t)||(t=or()),t&&n===null&&Je(t)?i.name=t:(n=n||yi(i.type),i.name=t+(n?"."+n:"")),i},Pi=function(){return window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder},sr=function(e,t){var r=Pi();if(r){var n=new r;return n.append(e),n.getBlob(t)}return new Blob([e],{type:t})},bi=function(e,t){for(var r=new ArrayBuffer(e.length),n=new Uint8Array(r),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return sr(r,t)},ur=function(e){return(/^data:(.+);/.exec(e)||[])[1]||null},Li=function(e){var t=e.split(",")[1];return t.replace(/\s/g,"")},Mi=function(e){return atob(Li(e))},Ci=function(e){var t=ur(e),r=Mi(e);return bi(r,t)},wi=function(e,t,r){return Ce(Ci(e),t,null,r)},Ni=function(e){if(!/^content-disposition:/i.test(e))return null;var t=e.split(/filename=|filename\*=.+''/).splice(1).map(function(r){return r.trim().replace(/^["']|[;"']{0,2}$/g,"")}).filter(function(r){return r.length});return t.length?decodeURI(t[t.length-1]):null},Fi=function(e){if(/content-length:/i.test(e)){var t=e.match(/[0-9]+/)[0];return t?parseInt(t,10):null}return null},Gi=function(e){if(/x-content-transfer-id:/i.test(e)){var t=(e.split(":")[1]||"").trim();return t||null}return null},Et=function(e){var t={source:null,name:null,size:null},r=e.split(`
`),n=!0,i=!1,o=void 0;try{for(var s=r[Symbol.iterator](),u;!(n=(u=s.next()).done);n=!0){var l=u.value,c=Ni(l);if(c){t.name=c;continue}var d=Fi(l);if(d){t.size=d;continue}var f=Gi(l);if(f){t.source=f;continue}}}catch(E){i=!0,o=E}finally{try{!n&&s.return!=null&&s.return()}finally{if(i)throw o}}return t},Bi=function(e){var t={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},r=function(){return t.progress},n=function(){t.request&&t.request.abort&&t.request.abort()},i=function(){var l=t.source;s.fire("init",l),l instanceof File?s.fire("load",l):l instanceof Blob?s.fire("load",Ce(l,l.name)):pt(l)?s.fire("load",wi(l)):o(l)},o=function(l){if(!e){s.fire("error",{type:"error",body:"Can't load URL",code:400});return}t.timestamp=Date.now(),t.request=e(l,function(c){t.duration=Date.now()-t.timestamp,t.complete=!0,c instanceof Blob&&(c=Ce(c,c.name||Ue(l))),s.fire("load",c instanceof Blob?c:c?c.body:null)},function(c){s.fire("error",typeof c=="string"?{type:"error",code:0,body:c}:c)},function(c,d,f){if(f&&(t.size=f),t.duration=Date.now()-t.timestamp,!c){t.progress=null;return}t.progress=d/f,s.fire("progress",t.progress)},function(){s.fire("abort")},function(c){var d=Et(typeof c=="string"?c:c.headers);s.fire("meta",{size:t.size||d.size,filename:d.name,source:d.source})})},s=Object.assign({},ke(),{setSource:function(l){return t.source=l},getProgress:r,abort:n,load:i});return s},lr=function(e){return/GET|HEAD/.test(e)},De=function(e,t,r){var n={onheaders:function(){},onprogress:function(){},onload:function(){},ontimeout:function(){},onerror:function(){},onabort:function(){},abort:function(){i=!0,s.abort()}},i=!1,o=!1;r=Object.assign({method:"POST",headers:{},withCredentials:!1},r),t=encodeURI(t),lr(r.method)&&e&&(t=""+t+encodeURIComponent(typeof e=="string"?e:JSON.stringify(e)));var s=new XMLHttpRequest,u=lr(r.method)?s:s.upload;return u.onprogress=function(l){i||n.onprogress(l.lengthComputable,l.loaded,l.total)},s.onreadystatechange=function(){s.readyState<2||s.readyState===4&&s.status===0||o||(o=!0,n.onheaders(s))},s.onload=function(){s.status>=200&&s.status<300?n.onload(s):n.onerror(s)},s.onerror=function(){return n.onerror(s)},s.onabort=function(){i=!0,n.onabort()},s.ontimeout=function(){return n.ontimeout(s)},s.open(r.method,t,!0),be(r.timeout)&&(s.timeout=r.timeout),Object.keys(r.headers).forEach(function(l){var c=unescape(encodeURIComponent(r.headers[l]));s.setRequestHeader(l,c)}),r.responseType&&(s.responseType=r.responseType),r.withCredentials&&(s.withCredentials=!0),s.send(e),n},$=function(e,t,r,n){return{type:e,code:t,body:r,headers:n}},Se=function(e){return function(t){e($("error",0,"Timeout",t.getAllResponseHeaders()))}},cr=function(e){return/\?/.test(e)},qe=function(){for(var e="",t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach(function(i){e+=cr(e)&&cr(i)?i.replace(/\?/,"&"):i}),e},gt=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(typeof t=="function")return t;if(!t||!re(t.url))return null;var r=t.onload||function(i){return i},n=t.onerror||function(i){return null};return function(i,o,s,u,l,c){var d=De(i,qe(e,t.url),Object.assign({},t,{responseType:"blob"}));return d.onload=function(f){var E=f.getAllResponseHeaders(),I=Et(E).name||Ue(i);o($("load",f.status,t.method==="HEAD"?null:Ce(r(f.response),I),E))},d.onerror=function(f){s($("error",f.status,n(f.response)||f.statusText,f.getAllResponseHeaders()))},d.onheaders=function(f){c($("headers",f.status,null,f.getAllResponseHeaders()))},d.ontimeout=Se(s),d.onprogress=u,d.onabort=l,d}},se={QUEUED:0,COMPLETE:1,PROCESSING:2,ERROR:3,WAITING:4},Ui=function(e,t,r,n,i,o,s,u,l,c,d){for(var f=[],E=d.chunkTransferId,I=d.chunkServer,T=d.chunkSize,p=d.chunkRetryDelays,_={serverId:E,aborted:!1},S=t.ondata||function(m){return m},P=t.onload||function(m,v){return v==="HEAD"?m.getResponseHeader("Upload-Offset"):m.response},R=t.onerror||function(m){return null},F=function(v){var y=new FormData;J(i)&&y.append(r,JSON.stringify(i));var w=typeof t.headers=="function"?t.headers(n,i):Object.assign({},t.headers,{"Upload-Length":n.size}),G=Object.assign({},t,{headers:w}),V=De(S(y),qe(e,t.url),G);V.onload=function(U){return v(P(U,G.method))},V.onerror=function(U){return s($("error",U.status,R(U.response)||U.statusText,U.getAllResponseHeaders()))},V.ontimeout=Se(s)},h=function(v){var y=qe(e,I.url,_.serverId),w=typeof t.headers=="function"?t.headers(_.serverId):Object.assign({},t.headers),G={headers:w,method:"HEAD"},V=De(null,y,G);V.onload=function(U){return v(P(U,G.method))},V.onerror=function(U){return s($("error",U.status,R(U.response)||U.statusText,U.getAllResponseHeaders()))},V.ontimeout=Se(s)},H=Math.floor(n.size/T),W=0;W<=H;W++){var D=W*T,b=n.slice(D,D+T,"application/offset+octet-stream");f[W]={index:W,size:b.size,offset:D,data:b,file:n,progress:0,retries:Qe(p),status:se.QUEUED,error:null,request:null,timeout:null}}var L=function(){return o(_.serverId)},O=function(v){return v.status===se.QUEUED||v.status===se.ERROR},A=function(v){if(!_.aborted){if(v=v||f.find(O),!v){f.every(function(x){return x.status===se.COMPLETE})&&L();return}v.status=se.PROCESSING,v.progress=null;var y=I.ondata||function(x){return x},w=I.onerror||function(x){return null},G=qe(e,I.url,_.serverId),V=typeof I.headers=="function"?I.headers(v):Object.assign({},I.headers,{"Content-Type":"application/offset+octet-stream","Upload-Offset":v.offset,"Upload-Length":n.size,"Upload-Name":n.name}),U=v.request=De(y(v.data),G,Object.assign({},I,{headers:V}));U.onload=function(){v.status=se.COMPLETE,v.request=null,Y()},U.onprogress=function(x,Ge,He){v.progress=x?Ge:null,j()},U.onerror=function(x){v.status=se.ERROR,v.request=null,v.error=w(x.response)||x.statusText,M(v)||s($("error",x.status,w(x.response)||x.statusText,x.getAllResponseHeaders()))},U.ontimeout=function(x){v.status=se.ERROR,v.request=null,M(v)||Se(s)(x)},U.onabort=function(){v.status=se.QUEUED,v.request=null,l()}}},M=function(v){return v.retries.length===0?!1:(v.status=se.WAITING,clearTimeout(v.timeout),v.timeout=setTimeout(function(){A(v)},v.retries.shift()),!0)},j=function(){var v=f.reduce(function(w,G){return w===null||G.progress===null?null:w+G.progress},0);if(v===null)return u(!1,0,0);var y=f.reduce(function(w,G){return w+G.size},0);u(!0,v,y)},Y=function(){var v=f.filter(function(y){return y.status===se.PROCESSING}).length;v>=1||A()},C=function(){f.forEach(function(v){clearTimeout(v.timeout),v.request&&v.request.abort()})};return _.serverId?h(function(m){_.aborted||(f.filter(function(v){return v.offset<m}).forEach(function(v){v.status=se.COMPLETE,v.progress=v.size}),Y())}):F(function(m){_.aborted||(c(m),_.serverId=m,Y())}),{abort:function(){_.aborted=!0,C()}}},Vi=function(e,t,r,n){return function(i,o,s,u,l,c,d){if(i){var f=n.chunkUploads,E=f&&i.size>n.chunkSize,I=f&&(E||n.chunkForce);if(i instanceof Blob&&I)return Ui(e,t,r,i,o,s,u,l,c,d,n);var T=t.ondata||function(h){return h},p=t.onload||function(h){return h},_=t.onerror||function(h){return null},S=typeof t.headers=="function"?t.headers(i,o)||{}:Object.assign({},t.headers),P=Object.assign({},t,{headers:S}),R=new FormData;J(o)&&R.append(r,JSON.stringify(o)),(i instanceof Blob?[{name:null,file:i}]:i).forEach(function(h){R.append(r,h.file,h.name===null?h.file.name:""+h.name+h.file.name)});var F=De(T(R),qe(e,t.url),P);return F.onload=function(h){s($("load",h.status,p(h.response),h.getAllResponseHeaders()))},F.onerror=function(h){u($("error",h.status,_(h.response)||h.statusText,h.getAllResponseHeaders()))},F.ontimeout=Se(u),F.onprogress=l,F.onabort=c,F}}},qi=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return typeof t=="function"?function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return t.apply(void 0,[r].concat(o,[n]))}:!t||!re(t.url)?null:Vi(e,t,r,n)},xe=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(typeof t=="function")return t;if(!t||!re(t.url))return function(i,o){return o()};var r=t.onload||function(i){return i},n=t.onerror||function(i){return null};return function(i,o,s){var u=De(i,e+t.url,t);return u.onload=function(l){o($("load",l.status,r(l.response),l.getAllResponseHeaders()))},u.onerror=function(l){s($("error",l.status,n(l.response)||l.statusText,l.getAllResponseHeaders()))},u.ontimeout=Se(s),u}},fr=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return e+Math.random()*(t-e)},xi=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:25,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:250,i=null,o=Date.now(),s=function u(){var l=Date.now()-o,c=fr(r,n);l+c>t&&(c=l+c-t);var d=l/t;if(d>=1||document.hidden){e(1);return}e(d),i=setTimeout(u,c)};return t>0&&s(),{clear:function(){clearTimeout(i)}}},Yi=function(e,t){var r={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},n=t.allowMinimumUploadDuration,i=function(f,E){var I=function(){r.duration===0||r.progress===null||c.fire("progress",c.getProgress())},T=function(){r.complete=!0,c.fire("load-perceived",r.response.body)};c.fire("start"),r.timestamp=Date.now(),r.perceivedPerformanceUpdater=xi(function(p){r.perceivedProgress=p,r.perceivedDuration=Date.now()-r.timestamp,I(),r.response&&r.perceivedProgress===1&&!r.complete&&T()},n?fr(750,1500):0),r.request=e(f,E,function(p){r.response=J(p)?p:{type:"load",code:200,body:""+p,headers:{}},r.duration=Date.now()-r.timestamp,r.progress=1,c.fire("load",r.response.body),(!n||n&&r.perceivedProgress===1)&&T()},function(p){r.perceivedPerformanceUpdater.clear(),c.fire("error",J(p)?p:{type:"error",code:0,body:""+p})},function(p,_,S){r.duration=Date.now()-r.timestamp,r.progress=p?_/S:null,I()},function(){r.perceivedPerformanceUpdater.clear(),c.fire("abort",r.response?r.response.body:null)},function(p){c.fire("transfer",p)})},o=function(){r.request&&(r.perceivedPerformanceUpdater.clear(),r.request.abort&&r.request.abort(),r.complete=!0)},s=function(){o(),r.complete=!1,r.perceivedProgress=0,r.progress=0,r.timestamp=null,r.perceivedDuration=0,r.duration=0,r.request=null,r.response=null},u=n?function(){return r.progress?Math.min(r.progress,r.perceivedProgress):null}:function(){return r.progress||null},l=n?function(){return Math.min(r.duration,r.perceivedDuration)}:function(){return r.duration},c=Object.assign({},ke(),{process:i,abort:o,getProgress:u,getDuration:l,reset:s});return c},dr=function(e){return e.substring(0,e.lastIndexOf("."))||e},Hi=function(e){var t=[e.name,e.size,e.type];return e instanceof Blob||pt(e)?t[0]=e.name||or():pt(e)?(t[1]=e.length,t[2]=ur(e)):re(e)&&(t[0]=Ue(e),t[1]=0,t[2]="application/octet-stream"),{name:t[0],size:t[1],type:t[2]}},we=function(e){return!!(e instanceof File||e instanceof Blob&&e.name)},Wi=function a(e){if(!J(e))return e;var t=je(e)?[]:{};for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];t[r]=n&&J(n)?a(n):n}return t},ji=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,n=ft(),i={archived:!1,frozen:!1,released:!1,source:null,file:r,serverFileReference:t,transferId:null,processingAborted:!1,status:t?N.PROCESSING_COMPLETE:N.INIT,activeLoader:null,activeProcessor:null},o=null,s={},u=function(b){return i.status=b},l=function(b){if(!(i.released||i.frozen)){for(var L=arguments.length,O=new Array(L>1?L-1:0),A=1;A<L;A++)O[A-1]=arguments[A];H.fire.apply(H,[b].concat(O))}},c=function(){return Je(i.file.name)},d=function(){return i.file.type},f=function(){return i.file.size},E=function(){return i.file},I=function(b,L,O){if(i.source=b,H.fireSync("init"),i.file){H.fireSync("load-skip");return}i.file=Hi(b),L.on("init",function(){l("load-init")}),L.on("meta",function(A){i.file.size=A.size,i.file.filename=A.filename,A.source&&(e=Z.LIMBO,i.serverFileReference=A.source,i.status=N.PROCESSING_COMPLETE),l("load-meta")}),L.on("progress",function(A){u(N.LOADING),l("load-progress",A)}),L.on("error",function(A){u(N.LOAD_ERROR),l("load-request-error",A)}),L.on("abort",function(){u(N.INIT),l("load-abort")}),L.on("load",function(A){i.activeLoader=null;var M=function(C){i.file=we(C)?C:i.file,e===Z.LIMBO&&i.serverFileReference?u(N.PROCESSING_COMPLETE):u(N.IDLE),l("load")},j=function(C){i.file=A,l("load-meta"),u(N.LOAD_ERROR),l("load-file-error",C)};if(i.serverFileReference){M(A);return}O(A,M,j)}),L.setSource(b),i.activeLoader=L,L.load()},T=function(){i.activeLoader&&i.activeLoader.load()},p=function(){if(i.activeLoader){i.activeLoader.abort();return}u(N.INIT),l("load-abort")},_=function D(b,L){if(i.processingAborted){i.processingAborted=!1;return}if(u(N.PROCESSING),o=null,!(i.file instanceof Blob)){H.on("load",function(){D(b,L)});return}b.on("load",function(M){i.transferId=null,i.serverFileReference=M}),b.on("transfer",function(M){i.transferId=M}),b.on("load-perceived",function(M){i.activeProcessor=null,i.transferId=null,i.serverFileReference=M,u(N.PROCESSING_COMPLETE),l("process-complete",M)}),b.on("start",function(){l("process-start")}),b.on("error",function(M){i.activeProcessor=null,u(N.PROCESSING_ERROR),l("process-error",M)}),b.on("abort",function(M){i.activeProcessor=null,i.serverFileReference=M,u(N.IDLE),l("process-abort"),o&&o()}),b.on("progress",function(M){l("process-progress",M)});var O=function(j){i.archived||b.process(j,Object.assign({},s))},A=console.error;L(i.file,O,A),i.activeProcessor=b},S=function(){i.processingAborted=!1,u(N.PROCESSING_QUEUED)},P=function(){return new Promise(function(b){if(!i.activeProcessor){i.processingAborted=!0,u(N.IDLE),l("process-abort"),b();return}o=function(){b()},i.activeProcessor.abort()})},R=function(b,L){return new Promise(function(O,A){var M=i.serverFileReference!==null?i.serverFileReference:i.transferId;if(M===null){O();return}b(M,function(){i.serverFileReference=null,i.transferId=null,O()},function(j){if(!L){O();return}u(N.PROCESSING_REVERT_ERROR),l("process-revert-error"),A(j)}),u(N.IDLE),l("process-revert")})},F=function(b,L,O){var A=b.split("."),M=A[0],j=A.pop(),Y=s;A.forEach(function(C){return Y=Y[C]}),JSON.stringify(Y[j])!==JSON.stringify(L)&&(Y[j]=L,l("metadata-update",{key:M,value:s[M],silent:O}))},h=function(b){return Wi(b?s[b]:s)},H=Object.assign({id:{get:function(){return n}},origin:{get:function(){return e},set:function(b){return e=b}},serverId:{get:function(){return i.serverFileReference}},transferId:{get:function(){return i.transferId}},status:{get:function(){return i.status}},filename:{get:function(){return i.file.name}},filenameWithoutExtension:{get:function(){return dr(i.file.name)}},fileExtension:{get:c},fileType:{get:d},fileSize:{get:f},file:{get:E},relativePath:{get:function(){return i.file._relativePath}},source:{get:function(){return i.source}},getMetadata:h,setMetadata:function(b,L,O){if(J(b)){var A=b;return Object.keys(A).forEach(function(M){F(M,A[M],L)}),b}return F(b,L,O),L},extend:function(b,L){return W[b]=L},abortLoad:p,retryLoad:T,requestProcessing:S,abortProcessing:P,load:I,process:_,revert:R},ke(),{freeze:function(){return i.frozen=!0},release:function(){return i.released=!0},released:{get:function(){return i.released}},archive:function(){return i.archived=!0},archived:{get:function(){return i.archived}}}),W=me(H);return W},zi=function(e,t){return ve(t)?0:re(t)?e.findIndex(function(r){return r.id===t}):-1},vr=function(e,t){var r=zi(e,t);if(!(r<0))return e[r]||null},pr=function(e,t,r,n,i,o){var s=De(null,e,{method:"GET",responseType:"blob"});return s.onload=function(u){var l=u.getAllResponseHeaders(),c=Et(l).name||Ue(e);t($("load",u.status,Ce(u.response,c),l))},s.onerror=function(u){r($("error",u.status,u.statusText,u.getAllResponseHeaders()))},s.onheaders=function(u){o($("headers",u.status,null,u.getAllResponseHeaders()))},s.ontimeout=Se(r),s.onprogress=n,s.onabort=i,s},Er=function(e){return e.indexOf("//")===0&&(e=location.protocol+e),e.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]},Xi=function(e){return(e.indexOf(":")>-1||e.indexOf("//")>-1)&&Er(location.href)!==Er(e)},et=function(e){return function(){return Re(e)?e.apply(void 0,arguments):e}},$i=function(e){return!we(e.file)},mt=function(e,t){clearTimeout(t.listUpdateTimeout),t.listUpdateTimeout=setTimeout(function(){e("DID_UPDATE_ITEMS",{items:ce(t.items)})},0)},gr=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new Promise(function(i){if(!e)return i(!0);var o=e.apply(void 0,r);if(o==null)return i(!0);if(typeof o=="boolean")return i(o);typeof o.then=="function"&&o.then(i)})},It=function(e,t){e.items.sort(function(r,n){return t(ne(r),ne(n))})},ue=function(e,t){return function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=r.query,i=r.success,o=i===void 0?function(){}:i,s=r.failure,u=s===void 0?function(){}:s,l=ai(r,["query","success","failure"]),c=Oe(e.items,n);if(!c){u({error:$("error",0,"Item not found"),file:null});return}t(c,o,u,l||{})}},Qi=function(e,t,r){return{ABORT_ALL:function(){ce(r.items).forEach(function(i){i.freeze(),i.abortLoad(),i.abortProcessing()})},DID_SET_FILES:function(i){var o=i.value,s=o===void 0?[]:o,u=s.map(function(c){return{source:c.source?c.source:c,options:c.options}}),l=ce(r.items);l.forEach(function(c){u.find(function(d){return d.source===c.source||d.source===c.file})||e("REMOVE_ITEM",{query:c,remove:!1})}),l=ce(r.items),u.forEach(function(c,d){l.find(function(f){return f.source===c.source||f.file===c.source})||e("ADD_ITEM",Object.assign({},c,{interactionMethod:oe.NONE,index:d}))})},DID_UPDATE_ITEM_METADATA:function(i){var o=i.id,s=i.action,u=i.change;u.silent||(clearTimeout(r.itemUpdateTimeout),r.itemUpdateTimeout=setTimeout(function(){var l=vr(r.items,o);if(!t("IS_ASYNC")){le("SHOULD_PREPARE_OUTPUT",!1,{item:l,query:t,action:s,change:u}).then(function(E){var I=t("GET_BEFORE_PREPARE_FILE");I&&(E=I(l,E)),E&&e("REQUEST_PREPARE_OUTPUT",{query:o,item:l,success:function(p){e("DID_PREPARE_OUTPUT",{id:o,file:p})}},!0)});return}l.origin===Z.LOCAL&&e("DID_LOAD_ITEM",{id:l.id,error:null,serverFileReference:l.source});var c=function(){setTimeout(function(){e("REQUEST_ITEM_PROCESSING",{query:o})},32)},d=function(I){l.revert(xe(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(I?c:function(){}).catch(function(){})},f=function(I){l.abortProcessing().then(I?c:function(){})};if(l.status===N.PROCESSING_COMPLETE)return d(r.options.instantUpload);if(l.status===N.PROCESSING)return f(r.options.instantUpload);r.options.instantUpload&&c()},0))},MOVE_ITEM:function(i){var o=i.query,s=i.index,u=Oe(r.items,o);if(u){var l=r.items.indexOf(u);s=ar(s,0,r.items.length-1),l!==s&&r.items.splice(s,0,r.items.splice(l,1)[0])}},SORT:function(i){var o=i.compare;It(r,o),e("DID_SORT_ITEMS",{items:t("GET_ACTIVE_ITEMS")})},ADD_ITEMS:function(i){var o=i.items,s=i.index,u=i.interactionMethod,l=i.success,c=l===void 0?function(){}:l,d=i.failure,f=d===void 0?function(){}:d,E=s;if(s===-1||typeof s>"u"){var I=t("GET_ITEM_INSERT_LOCATION"),T=t("GET_TOTAL_ITEMS");E=I==="before"?0:T}var p=t("GET_IGNORED_FILES"),_=function(F){return we(F)?!p.includes(F.name.toLowerCase()):!ve(F)},S=o.filter(_),P=S.map(function(R){return new Promise(function(F,h){e("ADD_ITEM",{interactionMethod:u,source:R.source||R,success:F,failure:h,index:E++,options:R.options||{}})})});Promise.all(P).then(c).catch(f)},ADD_ITEM:function(i){var o=i.source,s=i.index,u=s===void 0?-1:s,l=i.interactionMethod,c=i.success,d=c===void 0?function(){}:c,f=i.failure,E=f===void 0?function(){}:f,I=i.options,T=I===void 0?{}:I;if(ve(o)){E({error:$("error",0,"No source"),file:null});return}if(!(we(o)&&r.options.ignoredFiles.includes(o.name.toLowerCase()))){if(!Di(r)){if(r.options.allowMultiple||!r.options.allowMultiple&&!r.options.allowReplace){var p=$("warning",0,"Max files");e("DID_THROW_MAX_FILES",{source:o,error:p}),E({error:p,file:null});return}var _=ce(r.items)[0];if(_.status===N.PROCESSING_COMPLETE||_.status===N.PROCESSING_REVERT_ERROR){var S=t("GET_FORCE_REVERT");if(_.revert(xe(r.options.server.url,r.options.server.revert),S).then(function(){S&&e("ADD_ITEM",{source:o,index:u,interactionMethod:l,success:d,failure:E,options:T})}).catch(function(){}),S)return}e("REMOVE_ITEM",{query:_.id})}var P=T.type==="local"?Z.LOCAL:T.type==="limbo"?Z.LIMBO:Z.INPUT,R=ji(P,P===Z.INPUT?null:o,T.file);Object.keys(T.metadata||{}).forEach(function(O){R.setMetadata(O,T.metadata[O])}),he("DID_CREATE_ITEM",R,{query:t,dispatch:e});var F=t("GET_ITEM_INSERT_LOCATION");r.options.itemInsertLocationFreedom||(u=F==="before"?-1:r.items.length),Ai(r.items,R,u),Re(F)&&o&&It(r,F);var h=R.id;R.on("init",function(){e("DID_INIT_ITEM",{id:h})}),R.on("load-init",function(){e("DID_START_ITEM_LOAD",{id:h})}),R.on("load-meta",function(){e("DID_UPDATE_ITEM_META",{id:h})}),R.on("load-progress",function(O){e("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:h,progress:O})}),R.on("load-request-error",function(O){var A=et(r.options.labelFileLoadError)(O);if(O.code>=400&&O.code<500){e("DID_THROW_ITEM_INVALID",{id:h,error:O,status:{main:A,sub:O.code+" ("+O.body+")"}}),E({error:O,file:ne(R)});return}e("DID_THROW_ITEM_LOAD_ERROR",{id:h,error:O,status:{main:A,sub:r.options.labelTapToRetry}})}),R.on("load-file-error",function(O){e("DID_THROW_ITEM_INVALID",{id:h,error:O.status,status:O.status}),E({error:O.status,file:ne(R)})}),R.on("load-abort",function(){e("REMOVE_ITEM",{query:h})}),R.on("load-skip",function(){e("COMPLETE_LOAD_ITEM",{query:h,item:R,data:{source:o,success:d}})}),R.on("load",function(){var O=function(M){if(!M){e("REMOVE_ITEM",{query:h});return}R.on("metadata-update",function(j){e("DID_UPDATE_ITEM_METADATA",{id:h,change:j})}),le("SHOULD_PREPARE_OUTPUT",!1,{item:R,query:t}).then(function(j){var Y=t("GET_BEFORE_PREPARE_FILE");Y&&(j=Y(R,j));var C=function(){e("COMPLETE_LOAD_ITEM",{query:h,item:R,data:{source:o,success:d}}),mt(e,r)};if(j){e("REQUEST_PREPARE_OUTPUT",{query:h,item:R,success:function(v){e("DID_PREPARE_OUTPUT",{id:h,file:v}),C()}},!0);return}C()})};le("DID_LOAD_ITEM",R,{query:t,dispatch:e}).then(function(){gr(t("GET_BEFORE_ADD_FILE"),ne(R)).then(O)}).catch(function(A){if(!A||!A.error||!A.status)return O(!1);e("DID_THROW_ITEM_INVALID",{id:h,error:A.error,status:A.status})})}),R.on("process-start",function(){e("DID_START_ITEM_PROCESSING",{id:h})}),R.on("process-progress",function(O){e("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:h,progress:O})}),R.on("process-error",function(O){e("DID_THROW_ITEM_PROCESSING_ERROR",{id:h,error:O,status:{main:et(r.options.labelFileProcessingError)(O),sub:r.options.labelTapToRetry}})}),R.on("process-revert-error",function(O){e("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:h,error:O,status:{main:et(r.options.labelFileProcessingRevertError)(O),sub:r.options.labelTapToRetry}})}),R.on("process-complete",function(O){e("DID_COMPLETE_ITEM_PROCESSING",{id:h,error:null,serverFileReference:O}),e("DID_DEFINE_VALUE",{id:h,value:O})}),R.on("process-abort",function(){e("DID_ABORT_ITEM_PROCESSING",{id:h})}),R.on("process-revert",function(){e("DID_REVERT_ITEM_PROCESSING",{id:h}),e("DID_DEFINE_VALUE",{id:h,value:null})}),e("DID_ADD_ITEM",{id:h,index:u,interactionMethod:l}),mt(e,r);var H=r.options.server||{},W=H.url,D=H.load,b=H.restore,L=H.fetch;R.load(o,Bi(P===Z.INPUT?re(o)&&Xi(o)&&L?gt(W,L):pr:P===Z.LIMBO?gt(W,b):gt(W,D)),function(O,A,M){le("LOAD_FILE",O,{query:t}).then(A).catch(M)})}},REQUEST_PREPARE_OUTPUT:function(i){var o=i.item,s=i.success,u=i.failure,l=u===void 0?function(){}:u,c={error:$("error",0,"Item not found"),file:null};if(o.archived)return l(c);le("PREPARE_OUTPUT",o.file,{query:t,item:o}).then(function(d){le("COMPLETE_PREPARE_OUTPUT",d,{query:t,item:o}).then(function(f){if(o.archived)return l(c);s(f)})})},COMPLETE_LOAD_ITEM:function(i){var o=i.item,s=i.data,u=s.success,l=s.source,c=t("GET_ITEM_INSERT_LOCATION");if(Re(c)&&l&&It(r,c),e("DID_LOAD_ITEM",{id:o.id,error:null,serverFileReference:o.origin===Z.INPUT?null:l}),u(ne(o)),o.origin===Z.LOCAL){e("DID_LOAD_LOCAL_ITEM",{id:o.id});return}if(o.origin===Z.LIMBO){e("DID_COMPLETE_ITEM_PROCESSING",{id:o.id,error:null,serverFileReference:l}),e("DID_DEFINE_VALUE",{id:o.id,value:o.serverId||l});return}t("IS_ASYNC")&&r.options.instantUpload&&e("REQUEST_ITEM_PROCESSING",{query:o.id})},RETRY_ITEM_LOAD:ue(r,function(n){n.retryLoad()}),REQUEST_ITEM_PREPARE:ue(r,function(n,i,o){e("REQUEST_PREPARE_OUTPUT",{query:n.id,item:n,success:function(u){e("DID_PREPARE_OUTPUT",{id:n.id,file:u}),i({file:n,output:u})},failure:o},!0)}),REQUEST_ITEM_PROCESSING:ue(r,function(n,i,o){var s=n.status===N.IDLE||n.status===N.PROCESSING_ERROR;if(!s){var u=function(){return e("REQUEST_ITEM_PROCESSING",{query:n,success:i,failure:o})},l=function(){return document.hidden?u():setTimeout(u,32)};n.status===N.PROCESSING_COMPLETE||n.status===N.PROCESSING_REVERT_ERROR?n.revert(xe(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(l).catch(function(){}):n.status===N.PROCESSING&&n.abortProcessing().then(l);return}n.status!==N.PROCESSING_QUEUED&&(n.requestProcessing(),e("DID_REQUEST_ITEM_PROCESSING",{id:n.id}),e("PROCESS_ITEM",{query:n,success:i,failure:o},!0))}),PROCESS_ITEM:ue(r,function(n,i,o){var s=t("GET_MAX_PARALLEL_UPLOADS"),u=t("GET_ITEMS_BY_STATUS",N.PROCESSING).length;if(u===s){r.processingQueue.push({id:n.id,success:i,failure:o});return}if(n.status!==N.PROCESSING){var l=function d(){var f=r.processingQueue.shift();if(f){var E=f.id,I=f.success,T=f.failure,p=Oe(r.items,E);if(!p||p.archived){d();return}e("PROCESS_ITEM",{query:E,success:I,failure:T},!0)}};n.onOnce("process-complete",function(){i(ne(n)),l();var d=r.options.server,f=r.options.instantUpload;if(f&&n.origin===Z.LOCAL&&Re(d.remove)){var E=function(){};n.origin=Z.LIMBO,r.options.server.remove(n.source,E,E)}var I=t("GET_ITEMS_BY_STATUS",N.PROCESSING_COMPLETE).length===r.items.length;I&&e("DID_COMPLETE_ITEM_PROCESSING_ALL")}),n.onOnce("process-error",function(d){o({error:d,file:ne(n)}),l()});var c=r.options;n.process(Yi(qi(c.server.url,c.server.process,c.name,{chunkTransferId:n.transferId,chunkServer:c.server.patch,chunkUploads:c.chunkUploads,chunkForce:c.chunkForce,chunkSize:c.chunkSize,chunkRetryDelays:c.chunkRetryDelays}),{allowMinimumUploadDuration:t("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),function(d,f,E){le("PREPARE_OUTPUT",d,{query:t,item:n}).then(function(I){e("DID_PREPARE_OUTPUT",{id:n.id,file:I}),f(I)}).catch(E)})}}),RETRY_ITEM_PROCESSING:ue(r,function(n){e("REQUEST_ITEM_PROCESSING",{query:n})}),REQUEST_REMOVE_ITEM:ue(r,function(n){gr(t("GET_BEFORE_REMOVE_FILE"),ne(n)).then(function(i){i&&e("REMOVE_ITEM",{query:n})})}),RELEASE_ITEM:ue(r,function(n){n.release()}),REMOVE_ITEM:ue(r,function(n,i,o,s){var u=function(){var d=n.id;vr(r.items,d).archive(),e("DID_REMOVE_ITEM",{error:null,id:d,item:n}),mt(e,r),i(ne(n))},l=r.options.server;n.origin===Z.LOCAL&&l&&Re(l.remove)&&s.remove!==!1?(e("DID_START_ITEM_REMOVE",{id:n.id}),l.remove(n.source,function(){return u()},function(c){e("DID_THROW_ITEM_REMOVE_ERROR",{id:n.id,error:$("error",0,c,null),status:{main:et(r.options.labelFileRemoveError)(c),sub:r.options.labelTapToRetry}})})):((s.revert&&n.origin!==Z.LOCAL&&n.serverId!==null||r.options.chunkUploads&&n.file.size>r.options.chunkSize||r.options.chunkUploads&&r.options.chunkForce)&&n.revert(xe(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")),u())}),ABORT_ITEM_LOAD:ue(r,function(n){n.abortLoad()}),ABORT_ITEM_PROCESSING:ue(r,function(n){if(n.serverId){e("REVERT_ITEM_PROCESSING",{id:n.id});return}n.abortProcessing().then(function(){var i=r.options.instantUpload;i&&e("REMOVE_ITEM",{query:n.id})})}),REQUEST_REVERT_ITEM_PROCESSING:ue(r,function(n){if(!r.options.instantUpload){e("REVERT_ITEM_PROCESSING",{query:n});return}var i=function(l){l&&e("REVERT_ITEM_PROCESSING",{query:n})},o=t("GET_BEFORE_REMOVE_FILE");if(!o)return i(!0);var s=o(ne(n));if(s==null)return i(!0);if(typeof s=="boolean")return i(s);typeof s.then=="function"&&s.then(i)}),REVERT_ITEM_PROCESSING:ue(r,function(n){n.revert(xe(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(function(){var i=r.options.instantUpload||$i(n);i&&e("REMOVE_ITEM",{query:n.id})}).catch(function(){})}),SET_OPTIONS:function(i){var o=i.options,s=Object.keys(o),u=ki.filter(function(c){return s.includes(c)}),l=[].concat(Qe(u),Qe(Object.keys(o).filter(function(c){return!u.includes(c)})));l.forEach(function(c){e("SET_"+$e(c,"_").toUpperCase(),{value:o[c]})})}}},ki=["server"],Tt=function(e){return e},pe=function(e){return document.createElement(e)},Q=function(e,t){var r=e.childNodes[0];r?t!==r.nodeValue&&(r.nodeValue=t):(r=document.createTextNode(t),e.appendChild(r))},mr=function(e,t,r,n){var i=(n%360-90)*Math.PI/180;return{x:e+r*Math.cos(i),y:t+r*Math.sin(i)}},Ki=function(e,t,r,n,i,o){var s=mr(e,t,r,i),u=mr(e,t,r,n);return["M",s.x,s.y,"A",r,r,0,o,0,u.x,u.y].join(" ")},Zi=function(e,t,r,n,i){var o=1;return i>n&&i-n<=.5&&(o=0),n>i&&n-i>=.5&&(o=0),Ki(e,t,r,Math.min(.9999,n)*360,Math.min(.9999,i)*360,o)},Ji=function(e){var t=e.root,r=e.props;r.spin=!1,r.progress=0,r.opacity=0;var n=We("svg");t.ref.path=We("path",{"stroke-width":2,"stroke-linecap":"round"}),n.appendChild(t.ref.path),t.ref.svg=n,t.appendChild(n)},ea=function(e){var t=e.root,r=e.props;if(r.opacity!==0){r.align&&(t.element.dataset.align=r.align);var n=parseInt(k(t.ref.path,"stroke-width"),10),i=t.rect.element.width*.5,o=0,s=0;r.spin?(o=0,s=.5):(o=0,s=r.progress);var u=Zi(i,i,i-n,o,s);k(t.ref.path,"d",u),k(t.ref.path,"stroke-opacity",r.spin||r.progress>0?1:0)}},Ir=K({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:Ji,write:ea,mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),ta=function(e){var t=e.root,r=e.props;t.element.innerHTML=(r.icon||"")+("<span>"+r.label+"</span>"),r.isDisabled=!1},ra=function(e){var t=e.root,r=e.props,n=r.isDisabled,i=t.query("GET_DISABLED")||r.opacity===0;i&&!n?(r.isDisabled=!0,k(t.element,"disabled","disabled")):!i&&n&&(r.isDisabled=!1,t.element.removeAttribute("disabled"))},Tr=K({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:ta,write:ra}),_r=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:".",r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},i=n.labelBytes,o=i===void 0?"bytes":i,s=n.labelKilobytes,u=s===void 0?"KB":s,l=n.labelMegabytes,c=l===void 0?"MB":l,d=n.labelGigabytes,f=d===void 0?"GB":d;e=Math.round(Math.abs(e));var E=r,I=r*r,T=r*r*r;return e<E?e+" "+o:e<I?Math.floor(e/E)+" "+u:e<T?Rr(e/I,1,t)+" "+c:Rr(e/T,2,t)+" "+f},Rr=function(e,t,r){return e.toFixed(t).split(".").filter(function(n){return n!=="0"}).join(r)},na=function(e){var t=e.root,r=e.props,n=pe("span");n.className="filepond--file-info-main",k(n,"aria-hidden","true"),t.appendChild(n),t.ref.fileName=n;var i=pe("span");i.className="filepond--file-info-sub",t.appendChild(i),t.ref.fileSize=i,Q(i,t.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),Q(n,Tt(t.query("GET_ITEM_NAME",r.id)))},_t=function(e){var t=e.root,r=e.props;Q(t.ref.fileSize,_r(t.query("GET_ITEM_SIZE",r.id),".",t.query("GET_FILE_SIZE_BASE"),t.query("GET_FILE_SIZE_LABELS",t.query))),Q(t.ref.fileName,Tt(t.query("GET_ITEM_NAME",r.id)))},hr=function(e){var t=e.root,r=e.props;if(be(t.query("GET_ITEM_SIZE",r.id))){_t({root:t,props:r});return}Q(t.ref.fileSize,t.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},ia=K({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:te({DID_LOAD_ITEM:_t,DID_UPDATE_ITEM_META:_t,DID_THROW_ITEM_LOAD_ERROR:hr,DID_THROW_ITEM_INVALID:hr}),didCreateView:function(e){he("CREATE_VIEW",Object.assign({},e,{view:e}))},create:na,mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),Or=function(e){return Math.round(e*100)},aa=function(e){var t=e.root,r=pe("span");r.className="filepond--file-status-main",t.appendChild(r),t.ref.main=r;var n=pe("span");n.className="filepond--file-status-sub",t.appendChild(n),t.ref.sub=n,Dr({root:t,action:{progress:null}})},Dr=function(e){var t=e.root,r=e.action,n=r.progress===null?t.query("GET_LABEL_FILE_LOADING"):t.query("GET_LABEL_FILE_LOADING")+" "+Or(r.progress)+"%";Q(t.ref.main,n),Q(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},oa=function(e){var t=e.root,r=e.action,n=r.progress===null?t.query("GET_LABEL_FILE_PROCESSING"):t.query("GET_LABEL_FILE_PROCESSING")+" "+Or(r.progress)+"%";Q(t.ref.main,n),Q(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},sa=function(e){var t=e.root;Q(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING")),Q(t.ref.sub,t.query("GET_LABEL_TAP_TO_CANCEL"))},ua=function(e){var t=e.root;Q(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING_ABORTED")),Q(t.ref.sub,t.query("GET_LABEL_TAP_TO_RETRY"))},la=function(e){var t=e.root;Q(t.ref.main,t.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),Q(t.ref.sub,t.query("GET_LABEL_TAP_TO_UNDO"))},Sr=function(e){var t=e.root;Q(t.ref.main,""),Q(t.ref.sub,"")},Ye=function(e){var t=e.root,r=e.action;Q(t.ref.main,r.status.main),Q(t.ref.sub,r.status.sub)},ca=K({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:te({DID_LOAD_ITEM:Sr,DID_REVERT_ITEM_PROCESSING:Sr,DID_REQUEST_ITEM_PROCESSING:sa,DID_ABORT_ITEM_PROCESSING:ua,DID_COMPLETE_ITEM_PROCESSING:la,DID_UPDATE_ITEM_PROCESS_PROGRESS:oa,DID_UPDATE_ITEM_LOAD_PROGRESS:Dr,DID_THROW_ITEM_LOAD_ERROR:Ye,DID_THROW_ITEM_INVALID:Ye,DID_THROW_ITEM_PROCESSING_ERROR:Ye,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:Ye,DID_THROW_ITEM_REMOVE_ERROR:Ye}),didCreateView:function(e){he("CREATE_VIEW",Object.assign({},e,{view:e}))},create:aa,mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),Rt={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},ht=[];X(Rt,function(a){ht.push(a)});var ae=function(e){if(Ot(e)==="right")return 0;var t=e.ref.buttonRemoveItem.rect.element;return t.hidden?null:t.width+t.left},fa=function(e){var t=e.ref.buttonAbortItemLoad.rect.element;return t.width},tt=function(e){return Math.floor(e.ref.buttonRemoveItem.rect.element.height/4)},da=function(e){return Math.floor(e.ref.buttonRemoveItem.rect.element.left/2)},va=function(e){return e.query("GET_STYLE_LOAD_INDICATOR_POSITION")},pa=function(e){return e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")},Ot=function(e){return e.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION")},Ea={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:va},processProgressIndicator:{opacity:0,align:pa},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},Ar={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:ae},status:{translateX:ae}},Dt={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},Ne={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:ae},status:{translateX:ae,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:ae},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:Ot},info:{translateX:ae},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:Ot},buttonRemoveItem:{opacity:1},info:{translateX:ae},status:{opacity:1,translateX:ae}},DID_LOAD_ITEM:Ar,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:ae},status:{translateX:ae}},DID_START_ITEM_PROCESSING:Dt,DID_REQUEST_ITEM_PROCESSING:Dt,DID_UPDATE_ITEM_PROCESS_PROGRESS:Dt,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:ae}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:ae},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:Ar},ga=K({create:function(e){var t=e.root;t.element.innerHTML=t.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),ma=function(e){var t=e.root,r=e.props,n=Object.keys(Rt).reduce(function(S,P){return S[P]=Object.assign({},Rt[P]),S},{}),i=r.id,o=t.query("GET_ALLOW_REVERT"),s=t.query("GET_ALLOW_REMOVE"),u=t.query("GET_ALLOW_PROCESS"),l=t.query("GET_INSTANT_UPLOAD"),c=t.query("IS_ASYNC"),d=t.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN"),f;c?u&&!o?f=function(P){return!/RevertItemProcessing/.test(P)}:!u&&o?f=function(P){return!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(P)}:!u&&!o&&(f=function(P){return!/Process/.test(P)}):f=function(P){return!/Process/.test(P)};var E=f?ht.filter(f):ht.concat();if(l&&o&&(n.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",n.RevertItemProcessing.icon="GET_ICON_REMOVE"),c&&!o){var I=Ne.DID_COMPLETE_ITEM_PROCESSING;I.info.translateX=da,I.info.translateY=tt,I.status.translateY=tt,I.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(c&&!u&&(["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach(function(S){Ne[S].status.translateY=tt}),Ne.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=fa),d&&o){n.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";var T=Ne.DID_COMPLETE_ITEM_PROCESSING;T.info.translateX=ae,T.status.translateY=tt,T.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}s||(n.RemoveItem.disabled=!0),X(n,function(S,P){var R=t.createChildView(Tr,{label:t.query(P.label),icon:t.query(P.icon),opacity:0});E.includes(S)&&t.appendChildView(R),P.disabled&&(R.element.setAttribute("disabled","disabled"),R.element.setAttribute("hidden","hidden")),R.element.dataset.align=t.query("GET_STYLE_"+P.align),R.element.classList.add(P.className),R.on("click",function(F){F.stopPropagation(),!P.disabled&&t.dispatch(P.action,{query:i})}),t.ref["button"+S]=R}),t.ref.processingCompleteIndicator=t.appendChildView(t.createChildView(ga)),t.ref.processingCompleteIndicator.element.dataset.align=t.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION"),t.ref.info=t.appendChildView(t.createChildView(ia,{id:i})),t.ref.status=t.appendChildView(t.createChildView(ca,{id:i}));var p=t.appendChildView(t.createChildView(Ir,{opacity:0,align:t.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));p.element.classList.add("filepond--load-indicator"),t.ref.loadProgressIndicator=p;var _=t.appendChildView(t.createChildView(Ir,{opacity:0,align:t.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));_.element.classList.add("filepond--process-indicator"),t.ref.processProgressIndicator=_,t.ref.activeStyles=[]},Ia=function(e){var t=e.root,r=e.actions,n=e.props;Ta({root:t,actions:r,props:n});var i=r.concat().filter(function(s){return/^DID_/.test(s.type)}).reverse().find(function(s){return Ne[s.type]});if(i){t.ref.activeStyles=[];var o=Ne[i.type];X(Ea,function(s,u){var l=t.ref[s];X(u,function(c,d){var f=o[s]&&typeof o[s][c]<"u"?o[s][c]:d;t.ref.activeStyles.push({control:l,key:c,value:f})})})}t.ref.activeStyles.forEach(function(s){var u=s.control,l=s.key,c=s.value;u[l]=typeof c=="function"?c(t):c})},Ta=te({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:function(e){var t=e.root,r=e.action;t.ref.buttonAbortItemProcessing.label=r.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:function(e){var t=e.root,r=e.action;t.ref.buttonAbortItemLoad.label=r.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:function(e){var t=e.root,r=e.action;t.ref.buttonAbortItemRemoval.label=r.value},DID_REQUEST_ITEM_PROCESSING:function(e){var t=e.root;t.ref.processProgressIndicator.spin=!0,t.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:function(e){var t=e.root;t.ref.loadProgressIndicator.spin=!0,t.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:function(e){var t=e.root;t.ref.processProgressIndicator.spin=!0,t.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:function(e){var t=e.root,r=e.action;t.ref.loadProgressIndicator.spin=!1,t.ref.loadProgressIndicator.progress=r.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:function(e){var t=e.root,r=e.action;t.ref.processProgressIndicator.spin=!1,t.ref.processProgressIndicator.progress=r.progress}}),_a=K({create:ma,write:Ia,didCreateView:function(e){he("CREATE_VIEW",Object.assign({},e,{view:e}))},name:"file"}),Ra=function(e){var t=e.root,r=e.props;t.ref.fileName=pe("legend"),t.appendChild(t.ref.fileName),t.ref.file=t.appendChildView(t.createChildView(_a,{id:r.id})),t.ref.data=!1},ha=function(e){var t=e.root,r=e.props;Q(t.ref.fileName,Tt(t.query("GET_ITEM_NAME",r.id)))},Oa=K({create:Ra,ignoreRect:!0,write:te({DID_LOAD_ITEM:ha}),didCreateView:function(e){he("CREATE_VIEW",Object.assign({},e,{view:e}))},tag:"fieldset",name:"file-wrapper"}),yr={type:"spring",damping:.6,mass:7},Da=function(e){var t=e.root,r=e.props;[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:yr},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:yr},styles:["translateY"]}}].forEach(function(n){Sa(t,n,r.name)}),t.element.classList.add("filepond--"+r.name),t.ref.scalable=null},Sa=function(e,t,r){var n=K({name:"panel-"+t.name+" filepond--"+r,mixins:t.mixins,ignoreRectUpdate:!0}),i=e.createChildView(n,t.props);e.ref[t.name]=e.appendChildView(i)},Aa=function(e){var t=e.root,r=e.props;if((t.ref.scalable===null||r.scalable!==t.ref.scalable)&&(t.ref.scalable=Xt(r.scalable)?r.scalable:!0,t.element.dataset.scalable=t.ref.scalable),!!r.height){var n=t.ref.top.rect.element,i=t.ref.bottom.rect.element,o=Math.max(n.height+i.height,r.height);t.ref.center.translateY=n.height,t.ref.center.scaleY=(o-n.height-i.height)/100,t.ref.bottom.translateY=o-i.height}},Pr=K({name:"panel",read:function(e){var t=e.root,r=e.props;return r.heightCurrent=t.ref.bottom.translateY},write:Aa,create:Da,ignoreRect:!0,mixins:{apis:["height","heightCurrent","scalable"]}}),ya=function(e){var t=e.map(function(n){return n.id}),r=void 0;return{setIndex:function(i){r=i},getIndex:function(){return r},getItemIndex:function(i){return t.indexOf(i.id)}}},br={type:"spring",stiffness:.75,damping:.45,mass:10},Lr="spring",Mr={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},Pa=function(e){var t=e.root,r=e.props;if(t.ref.handleClick=function(i){return t.dispatch("DID_ACTIVATE_ITEM",{id:r.id})},t.element.id="filepond--item-"+r.id,t.element.addEventListener("click",t.ref.handleClick),t.ref.container=t.appendChildView(t.createChildView(Oa,{id:r.id})),t.ref.panel=t.appendChildView(t.createChildView(Pr,{name:"item-panel"})),t.ref.panel.height=null,r.markedForRemoval=!1,!!t.query("GET_ALLOW_REORDER")){t.element.dataset.dragState="idle";var n=function(o){if(o.isPrimary){var s=!1,u={x:o.pageX,y:o.pageY};r.dragOrigin={x:t.translateX,y:t.translateY},r.dragCenter={x:o.offsetX,y:o.offsetY};var l=ya(t.query("GET_ACTIVE_ITEMS"));t.dispatch("DID_GRAB_ITEM",{id:r.id,dragState:l});var c=function(E){if(E.isPrimary){E.stopPropagation(),E.preventDefault(),r.dragOffset={x:E.pageX-u.x,y:E.pageY-u.y};var I=r.dragOffset.x*r.dragOffset.x+r.dragOffset.y*r.dragOffset.y;I>16&&!s&&(s=!0,t.element.removeEventListener("click",t.ref.handleClick)),t.dispatch("DID_DRAG_ITEM",{id:r.id,dragState:l})}},d=function f(E){E.isPrimary&&(document.removeEventListener("pointermove",c),document.removeEventListener("pointerup",f),r.dragOffset={x:E.pageX-u.x,y:E.pageY-u.y},t.dispatch("DID_DROP_ITEM",{id:r.id,dragState:l}),s&&setTimeout(function(){return t.element.addEventListener("click",t.ref.handleClick)},0))};document.addEventListener("pointermove",c),document.addEventListener("pointerup",d)}};t.element.addEventListener("pointerdown",n)}},ba=te({DID_UPDATE_PANEL_HEIGHT:function(e){var t=e.root,r=e.action;t.height=r.height}}),La=te({DID_GRAB_ITEM:function(e){var t=e.root,r=e.props;r.dragOrigin={x:t.translateX,y:t.translateY}},DID_DRAG_ITEM:function(e){var t=e.root;t.element.dataset.dragState="drag"},DID_DROP_ITEM:function(e){var t=e.root,r=e.props;r.dragOffset=null,r.dragOrigin=null,t.element.dataset.dragState="drop"}},function(a){var e=a.root,t=a.actions,r=a.props,n=a.shouldOptimize;e.element.dataset.dragState==="drop"&&e.scaleX<=1&&(e.element.dataset.dragState="idle");var i=t.concat().filter(function(s){return/^DID_/.test(s.type)}).reverse().find(function(s){return Mr[s.type]});i&&i.type!==r.currentState&&(r.currentState=i.type,e.element.dataset.filepondItemState=Mr[r.currentState]||"");var o=e.query("GET_ITEM_PANEL_ASPECT_RATIO")||e.query("GET_PANEL_ASPECT_RATIO");o?n||(e.height=e.rect.element.width*o):(ba({root:e,actions:t,props:r}),!e.height&&e.ref.container.rect.element.height>0&&(e.height=e.ref.container.rect.element.height)),n&&(e.ref.panel.height=null),e.ref.panel.height=e.height}),Ma=K({create:Pa,write:La,destroy:function(e){var t=e.root,r=e.props;t.element.removeEventListener("click",t.ref.handleClick),t.dispatch("RELEASE_ITEM",{query:r.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:Lr,scaleY:Lr,translateX:br,translateY:br,opacity:{type:"tween",duration:150}}}}),St=function(a,e){return Math.max(1,Math.floor((a+1)/e))},At=function(e,t,r){if(r){var n=e.rect.element.width,i=t.length,o=null;if(i===0||r.top<t[0].rect.element.top)return-1;var s=t[0],u=s.rect.element,l=u.marginLeft+u.marginRight,c=u.width+l,d=St(n,c);if(d===1){for(var f=0;f<i;f++){var E=t[f],I=E.rect.outer.top+E.rect.element.height*.5;if(r.top<I)return f}return i}for(var T=u.marginTop+u.marginBottom,p=u.height+T,_=0;_<i;_++){var S=_%d,P=Math.floor(_/d),R=S*c,F=P*p,h=F-u.marginTop,H=R+c,W=F+p+u.marginBottom;if(r.top<W&&r.top>h){if(r.left<H)return _;_!==i-1?o=_:o=null}}return o!==null?o:i}},rt={height:0,width:0,get getHeight(){return this.height},set setHeight(a){(this.height===0||a===0)&&(this.height=a)},get getWidth(){return this.width},set setWidth(a){(this.width===0||a===0)&&(this.width=a)},setDimensions:function(e,t){(this.height===0||e===0)&&(this.height=e),(this.width===0||t===0)&&(this.width=t)}},Ca=function(e){var t=e.root;k(t.element,"role","list"),t.ref.lastItemSpanwDate=Date.now()},wa=function(e){var t=e.root,r=e.action,n=r.id,i=r.index,o=r.interactionMethod;t.ref.addIndex=i;var s=Date.now(),u=s,l=1;if(o!==oe.NONE){l=0;var c=t.query("GET_ITEM_INSERT_INTERVAL"),d=s-t.ref.lastItemSpanwDate;u=d<c?s+(c-d):s}t.ref.lastItemSpanwDate=u,t.appendChildView(t.createChildView(Ma,{spawnDate:u,id:n,opacity:l,interactionMethod:o}),i)},Cr=function(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1;e.dragOffset?(e.translateX=null,e.translateY=null,e.translateX=e.dragOrigin.x+e.dragOffset.x,e.translateY=e.dragOrigin.y+e.dragOffset.y,e.scaleX=1.025,e.scaleY=1.025):(e.translateX=t,e.translateY=r,Date.now()>e.spawnDate&&(e.opacity===0&&Na(e,t,r,n,i),e.scaleX=1,e.scaleY=1,e.opacity=1))},Na=function(e,t,r,n,i){e.interactionMethod===oe.NONE?(e.translateX=null,e.translateX=t,e.translateY=null,e.translateY=r):e.interactionMethod===oe.DROP?(e.translateX=null,e.translateX=t-n*20,e.translateY=null,e.translateY=r-i*10,e.scaleX=.8,e.scaleY=.8):e.interactionMethod===oe.BROWSE?(e.translateY=null,e.translateY=r-30):e.interactionMethod===oe.API&&(e.translateX=null,e.translateX=t-30,e.translateY=null)},Fa=function(e){var t=e.root,r=e.action,n=r.id,i=t.childViews.find(function(o){return o.id===n});i&&(i.scaleX=.9,i.scaleY=.9,i.opacity=0,i.markedForRemoval=!0)},yt=function(e){return e.rect.element.height+e.rect.element.marginBottom*.5+e.rect.element.marginTop*.5},Ga=function(e){return e.rect.element.width+e.rect.element.marginLeft*.5+e.rect.element.marginRight*.5},Ba=function(e){var t=e.root,r=e.action,n=r.id,i=r.dragState,o=t.query("GET_ITEM",{id:n}),s=t.childViews.find(function(S){return S.id===n}),u=t.childViews.length,l=i.getItemIndex(o);if(s){var c={x:s.dragOrigin.x+s.dragOffset.x+s.dragCenter.x,y:s.dragOrigin.y+s.dragOffset.y+s.dragCenter.y},d=yt(s),f=Ga(s),E=Math.floor(t.rect.outer.width/f);E>u&&(E=u);var I=Math.floor(u/E+1);rt.setHeight=d*I,rt.setWidth=f*E;var T={y:Math.floor(c.y/d),x:Math.floor(c.x/f),getGridIndex:function(){return c.y>rt.getHeight||c.y<0||c.x>rt.getWidth||c.x<0?l:this.y*E+this.x},getColIndex:function(){for(var P=t.query("GET_ACTIVE_ITEMS"),R=t.childViews.filter(function(M){return M.rect.element.height}),F=P.map(function(M){return R.find(function(j){return j.id===M.id})}),h=F.findIndex(function(M){return M===s}),H=yt(s),W=F.length,D=W,b=0,L=0,O=0,A=0;A<W;A++)if(b=yt(F[A]),O=L,L=O+b,c.y<L){if(h>A){if(c.y<O+H){D=A;break}continue}D=A;break}return D}},p=E>1?T.getGridIndex():T.getColIndex();t.dispatch("MOVE_ITEM",{query:s,index:p});var _=i.getIndex();if(_===void 0||_!==p){if(i.setIndex(p),_===void 0)return;t.dispatch("DID_REORDER_ITEMS",{items:t.query("GET_ACTIVE_ITEMS"),origin:l,target:p})}}},Ua=te({DID_ADD_ITEM:wa,DID_REMOVE_ITEM:Fa,DID_DRAG_ITEM:Ba}),Va=function(e){var t=e.root,r=e.props,n=e.actions,i=e.shouldOptimize;Ua({root:t,props:r,actions:n});var o=r.dragCoordinates,s=t.rect.element.width,u=t.childViews.filter(function(D){return D.rect.element.height}),l=t.query("GET_ACTIVE_ITEMS").map(function(D){return u.find(function(b){return b.id===D.id})}).filter(function(D){return D}),c=o?At(t,l,o):null,d=t.ref.addIndex||null;t.ref.addIndex=null;var f=0,E=0,I=0;if(l.length!==0){var T=l[0].rect.element,p=T.marginTop+T.marginBottom,_=T.marginLeft+T.marginRight,S=T.width+_,P=T.height+p,R=St(s,S);if(R===1){var F=0,h=0;l.forEach(function(D,b){if(c){var L=b-c;L===-2?h=-p*.25:L===-1?h=-p*.75:L===0?h=p*.75:L===1?h=p*.25:h=0}i&&(D.translateX=null,D.translateY=null),D.markedForRemoval||Cr(D,0,F+h);var O=D.rect.element.height+p,A=O*(D.markedForRemoval?D.opacity:1);F+=A})}else{var H=0,W=0;l.forEach(function(D,b){b===c&&(f=1),b===d&&(I+=1),D.markedForRemoval&&D.opacity<.5&&(E-=1);var L=b+I+f+E,O=L%R,A=Math.floor(L/R),M=O*S,j=A*P,Y=Math.sign(M-H),C=Math.sign(j-W);H=M,W=j,!D.markedForRemoval&&(i&&(D.translateX=null,D.translateY=null),Cr(D,M,j,Y,C))})}}},qa=function(e,t){return t.filter(function(r){return r.data&&r.data.id?e.id===r.data.id:!0})},xa=K({create:Ca,write:Va,tag:"ul",name:"list",didWriteView:function(e){var t=e.root;t.childViews.filter(function(r){return r.markedForRemoval&&r.opacity===0&&r.resting}).forEach(function(r){r._destroy(),t.removeChildView(r)})},filterFrameActionsForChild:qa,mixins:{apis:["dragCoordinates"]}}),Ya=function(e){var t=e.root,r=e.props;t.ref.list=t.appendChildView(t.createChildView(xa)),r.dragCoordinates=null,r.overflowing=!1},Ha=function(e){var t=e.root,r=e.props,n=e.action;t.query("GET_ITEM_INSERT_LOCATION_FREEDOM")&&(r.dragCoordinates={left:n.position.scopeLeft-t.ref.list.rect.element.left,top:n.position.scopeTop-(t.rect.outer.top+t.rect.element.marginTop+t.rect.element.scrollTop)})},Wa=function(e){var t=e.props;t.dragCoordinates=null},ja=te({DID_DRAG:Ha,DID_END_DRAG:Wa}),za=function(e){var t=e.root,r=e.props,n=e.actions;if(ja({root:t,props:r,actions:n}),t.ref.list.dragCoordinates=r.dragCoordinates,r.overflowing&&!r.overflow&&(r.overflowing=!1,t.element.dataset.state="",t.height=null),r.overflow){var i=Math.round(r.overflow);i!==t.height&&(r.overflowing=!0,t.element.dataset.state="overflow",t.height=i)}},Xa=K({create:Ya,write:za,name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),fe=function(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";r?k(e,t,n):e.removeAttribute(t)},$a=function(e){if(!(!e||e.value==="")){try{e.value=""}catch{}if(e.value){var t=pe("form"),r=e.parentNode,n=e.nextSibling;t.appendChild(e),t.reset(),n?r.insertBefore(e,n):r.appendChild(e)}}},Qa=function(e){var t=e.root,r=e.props;t.element.id="filepond--browser-"+r.id,k(t.element,"name",t.query("GET_NAME")),k(t.element,"aria-controls","filepond--assistant-"+r.id),k(t.element,"aria-labelledby","filepond--drop-label-"+r.id),wr({root:t,action:{value:t.query("GET_ACCEPTED_FILE_TYPES")}}),Nr({root:t,action:{value:t.query("GET_ALLOW_MULTIPLE")}}),Fr({root:t,action:{value:t.query("GET_ALLOW_DIRECTORIES_ONLY")}}),Pt({root:t}),Gr({root:t,action:{value:t.query("GET_REQUIRED")}}),Br({root:t,action:{value:t.query("GET_CAPTURE_METHOD")}}),t.ref.handleChange=function(n){if(t.element.value){var i=Array.from(t.element.files).map(function(o){return o._relativePath=o.webkitRelativePath,o});setTimeout(function(){r.onload(i),$a(t.element)},250)}},t.element.addEventListener("change",t.ref.handleChange)},wr=function(e){var t=e.root,r=e.action;t.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")&&fe(t.element,"accept",!!r.value,r.value?r.value.join(","):"")},Nr=function(e){var t=e.root,r=e.action;fe(t.element,"multiple",r.value)},Fr=function(e){var t=e.root,r=e.action;fe(t.element,"webkitdirectory",r.value)},Pt=function(e){var t=e.root,r=t.query("GET_DISABLED"),n=t.query("GET_ALLOW_BROWSE"),i=r||!n;fe(t.element,"disabled",i)},Gr=function(e){var t=e.root,r=e.action;r.value?t.query("GET_TOTAL_ITEMS")===0&&fe(t.element,"required",!0):fe(t.element,"required",!1)},Br=function(e){var t=e.root,r=e.action;fe(t.element,"capture",!!r.value,r.value===!0?"":r.value)},Ur=function(e){var t=e.root,r=t.element;if(t.query("GET_TOTAL_ITEMS")>0)fe(r,"required",!1),fe(r,"name",!1);else{fe(r,"name",!0,t.query("GET_NAME"));var n=t.query("GET_CHECK_VALIDITY");n&&r.setCustomValidity(""),t.query("GET_REQUIRED")&&fe(r,"required",!0)}},ka=function(e){var t=e.root,r=t.query("GET_CHECK_VALIDITY");r&&t.element.setCustomValidity(t.query("GET_LABEL_INVALID_FIELD"))},Ka=K({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:Qa,destroy:function(e){var t=e.root;t.element.removeEventListener("change",t.ref.handleChange)},write:te({DID_LOAD_ITEM:Ur,DID_REMOVE_ITEM:Ur,DID_THROW_ITEM_INVALID:ka,DID_SET_DISABLED:Pt,DID_SET_ALLOW_BROWSE:Pt,DID_SET_ALLOW_DIRECTORIES_ONLY:Fr,DID_SET_ALLOW_MULTIPLE:Nr,DID_SET_ACCEPTED_FILE_TYPES:wr,DID_SET_CAPTURE_METHOD:Br,DID_SET_REQUIRED:Gr})}),Vr={ENTER:13,SPACE:32},Za=function(e){var t=e.root,r=e.props,n=pe("label");k(n,"for","filepond--browser-"+r.id),k(n,"id","filepond--drop-label-"+r.id),k(n,"aria-hidden","true"),t.ref.handleKeyDown=function(i){var o=i.keyCode===Vr.ENTER||i.keyCode===Vr.SPACE;o&&(i.preventDefault(),t.ref.label.click())},t.ref.handleClick=function(i){var o=i.target===n||n.contains(i.target);o||t.ref.label.click()},n.addEventListener("keydown",t.ref.handleKeyDown),t.element.addEventListener("click",t.ref.handleClick),qr(n,r.caption),t.appendChild(n),t.ref.label=n},qr=function(e,t){e.innerHTML=t;var r=e.querySelector(".filepond--label-action");return r&&k(r,"tabindex","0"),t},Ja=K({name:"drop-label",ignoreRect:!0,create:Za,destroy:function(e){var t=e.root;t.ref.label.addEventListener("keydown",t.ref.handleKeyDown),t.element.removeEventListener("click",t.ref.handleClick)},write:te({DID_SET_LABEL_IDLE:function(e){var t=e.root,r=e.action;qr(t.ref.label,r.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),eo=K({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),to=function(e){var t=e.root,r=t.rect.element.width*.5,n=t.rect.element.height*.5;t.ref.blob=t.appendChildView(t.createChildView(eo,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:r,translateY:n}))},ro=function(e){var t=e.root,r=e.action;if(!t.ref.blob){to({root:t});return}t.ref.blob.translateX=r.position.scopeLeft,t.ref.blob.translateY=r.position.scopeTop,t.ref.blob.scaleX=1,t.ref.blob.scaleY=1,t.ref.blob.opacity=1},no=function(e){var t=e.root;t.ref.blob&&(t.ref.blob.opacity=0)},io=function(e){var t=e.root;t.ref.blob&&(t.ref.blob.scaleX=2.5,t.ref.blob.scaleY=2.5,t.ref.blob.opacity=0)},ao=function(e){var t=e.root,r=e.props,n=e.actions;oo({root:t,props:r,actions:n});var i=t.ref.blob;n.length===0&&i&&i.opacity===0&&(t.removeChildView(i),t.ref.blob=null)},oo=te({DID_DRAG:ro,DID_DROP:io,DID_END_DRAG:no}),so=K({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:ao}),xr=function(e,t){try{var r=new DataTransfer;t.forEach(function(n){n instanceof File?r.items.add(n):r.items.add(new File([n],n.name,{type:n.type}))}),e.files=r.files}catch{return!1}return!0},uo=function(e){var t=e.root;return t.ref.fields={}},nt=function(e,t){return e.ref.fields[t]},bt=function(e){e.query("GET_ACTIVE_ITEMS").forEach(function(t){e.ref.fields[t.id]&&e.element.appendChild(e.ref.fields[t.id])})},Yr=function(e){var t=e.root;return bt(t)},lo=function(e){var t=e.root,r=e.action,n=t.query("GET_ITEM",r.id),i=n.origin===Z.LOCAL,o=!i&&t.query("SHOULD_UPDATE_FILE_INPUT"),s=pe("input");s.type=o?"file":"hidden",s.name=t.query("GET_NAME"),s.disabled=t.query("GET_DISABLED"),t.ref.fields[r.id]=s,bt(t)},co=function(e){var t=e.root,r=e.action,n=nt(t,r.id);if(n&&(r.serverFileReference!==null&&(n.value=r.serverFileReference),!!t.query("SHOULD_UPDATE_FILE_INPUT"))){var i=t.query("GET_ITEM",r.id);xr(n,[i.file])}},fo=function(e){var t=e.root,r=e.action;t.query("SHOULD_UPDATE_FILE_INPUT")&&setTimeout(function(){var n=nt(t,r.id);n&&xr(n,[r.file])},0)},vo=function(e){var t=e.root;t.element.disabled=t.query("GET_DISABLED")},po=function(e){var t=e.root,r=e.action,n=nt(t,r.id);n&&(n.parentNode&&n.parentNode.removeChild(n),delete t.ref.fields[r.id])},Eo=function(e){var t=e.root,r=e.action,n=nt(t,r.id);n&&(r.value===null?n.removeAttribute("value"):n.value=r.value,bt(t))},go=te({DID_SET_DISABLED:vo,DID_ADD_ITEM:lo,DID_LOAD_ITEM:co,DID_REMOVE_ITEM:po,DID_DEFINE_VALUE:Eo,DID_PREPARE_OUTPUT:fo,DID_REORDER_ITEMS:Yr,DID_SORT_ITEMS:Yr}),mo=K({tag:"fieldset",name:"data",create:uo,write:go,ignoreRect:!0}),Io=function(e){return"getRootNode"in e?e.getRootNode():document},To=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],_o=["css","csv","html","txt"],Ro={zip:"zip|compressed",epub:"application/epub+zip"},Hr=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return e=e.toLowerCase(),To.includes(e)?"image/"+(e==="jpg"?"jpeg":e==="svg"?"svg+xml":e):_o.includes(e)?"text/"+e:Ro[e]||""},Lt=function(e){return new Promise(function(t,r){var n=bo(e);if(n.length&&!ho(e))return t(n);Oo(e).then(t)})},ho=function(e){return e.files?e.files.length>0:!1},Oo=function(e){return new Promise(function(t,r){var n=(e.items?Array.from(e.items):[]).filter(function(i){return Do(i)}).map(function(i){return So(i)});if(!n.length){t(e.files?Array.from(e.files):[]);return}Promise.all(n).then(function(i){var o=[];i.forEach(function(s){o.push.apply(o,s)}),t(o.filter(function(s){return s}).map(function(s){return s._relativePath||(s._relativePath=s.webkitRelativePath),s}))}).catch(console.error)})},Do=function(e){if(Wr(e)){var t=Mt(e);if(t)return t.isFile||t.isDirectory}return e.kind==="file"},So=function(e){return new Promise(function(t,r){if(Po(e)){Ao(Mt(e)).then(t).catch(r);return}t([e.getAsFile()])})},Ao=function(e){return new Promise(function(t,r){var n=[],i=0,o=0,s=function(){o===0&&i===0&&t(n)},u=function l(c){i++;var d=c.createReader(),f=function E(){d.readEntries(function(I){if(I.length===0){i--,s();return}I.forEach(function(T){T.isDirectory?l(T):(o++,T.file(function(p){var _=yo(p);T.fullPath&&(_._relativePath=T.fullPath),n.push(_),o--,s()}))}),E()},r)};f()};u(e)})},yo=function(e){if(e.type.length)return e;var t=e.lastModifiedDate,r=e.name,n=Hr(Je(e.name));return n.length&&(e=e.slice(0,e.size,n),e.name=r,e.lastModifiedDate=t),e},Po=function(e){return Wr(e)&&(Mt(e)||{}).isDirectory},Wr=function(e){return"webkitGetAsEntry"in e},Mt=function(e){return e.webkitGetAsEntry()},bo=function(e){var t=[];try{if(t=Mo(e),t.length)return t;t=Lo(e)}catch{}return t},Lo=function(e){var t=e.getData("url");return typeof t=="string"&&t.length?[t]:[]},Mo=function(e){var t=e.getData("text/html");if(typeof t=="string"&&t.length){var r=t.match(/src\s*=\s*"(.+?)"/);if(r)return[r[1]]}return[]},it=[],Ae=function(e){return{pageLeft:e.pageX,pageTop:e.pageY,scopeLeft:e.offsetX||e.layerX,scopeTop:e.offsetY||e.layerY}},Co=function(e,t,r){var n=wo(t),i={element:e,filterElement:r,state:null,ondrop:function(){},onenter:function(){},ondrag:function(){},onexit:function(){},onload:function(){},allowdrop:function(){}};return i.destroy=n.addListener(i),i},wo=function(e){var t=it.find(function(n){return n.element===e});if(t)return t;var r=No(e);return it.push(r),r},No=function(e){var t=[],r={dragenter:Go,dragover:Bo,dragleave:Vo,drop:Uo},n={};X(r,function(o,s){n[o]=s(e,t),e.addEventListener(o,n[o],!1)});var i={element:e,addListener:function(s){return t.push(s),function(){t.splice(t.indexOf(s),1),t.length===0&&(it.splice(it.indexOf(i),1),X(r,function(u){e.removeEventListener(u,n[u],!1)}))}}};return i},Fo=function(e,t){return"elementFromPoint"in e||(e=document),e.elementFromPoint(t.x,t.y)},Ct=function(e,t){var r=Io(t),n=Fo(r,{x:e.pageX-window.pageXOffset,y:e.pageY-window.pageYOffset});return n===t||t.contains(n)},jr=null,at=function(e,t){try{e.dropEffect=t}catch{}},Go=function(e,t){return function(r){r.preventDefault(),jr=r.target,t.forEach(function(n){var i=n.element,o=n.onenter;Ct(r,i)&&(n.state="enter",o(Ae(r)))})}},Bo=function(e,t){return function(r){r.preventDefault();var n=r.dataTransfer;Lt(n).then(function(i){var o=!1;t.some(function(s){var u=s.filterElement,l=s.element,c=s.onenter,d=s.onexit,f=s.ondrag,E=s.allowdrop;at(n,"copy");var I=E(i);if(!I){at(n,"none");return}if(Ct(r,l)){if(o=!0,s.state===null){s.state="enter",c(Ae(r));return}if(s.state="over",u&&!I){at(n,"none");return}f(Ae(r))}else u&&!o&&at(n,"none"),s.state&&(s.state=null,d(Ae(r)))})})}},Uo=function(e,t){return function(r){r.preventDefault();var n=r.dataTransfer;Lt(n).then(function(i){t.forEach(function(o){var s=o.filterElement,u=o.element,l=o.ondrop,c=o.onexit,d=o.allowdrop;if(o.state=null,!(s&&!Ct(r,u))){if(!d(i))return c(Ae(r));l(Ae(r),i)}})})}},Vo=function(e,t){return function(r){jr===r.target&&t.forEach(function(n){var i=n.onexit;n.state=null,i(Ae(r))})}},qo=function(e,t,r){e.classList.add("filepond--hopper");var n=r.catchesDropsOnPage,i=r.requiresDropOnElement,o=r.filterItems,s=o===void 0?function(f){return f}:o,u=Co(e,n?document.documentElement:e,i),l="",c="";u.allowdrop=function(f){return t(s(f))},u.ondrop=function(f,E){var I=s(E);if(!t(I)){d.ondragend(f);return}c="drag-drop",d.onload(I,f)},u.ondrag=function(f){d.ondrag(f)},u.onenter=function(f){c="drag-over",d.ondragstart(f)},u.onexit=function(f){c="drag-exit",d.ondragend(f)};var d={updateHopperState:function(){l!==c&&(e.dataset.hopperState=c,l=c)},onload:function(){},ondragstart:function(){},ondrag:function(){},ondragend:function(){},destroy:function(){u.destroy()}};return d},wt=!1,Fe=[],zr=function(e){var t=document.activeElement;if(t&&/textarea|input/i.test(t.nodeName)){for(var r=!1,n=t;n!==document.body;){if(n.classList.contains("filepond--root")){r=!0;break}n=n.parentNode}if(!r)return}Lt(e.clipboardData).then(function(i){i.length&&Fe.forEach(function(o){return o(i)})})},xo=function(e){Fe.includes(e)||(Fe.push(e),!wt&&(wt=!0,document.addEventListener("paste",zr)))},Yo=function(e){dt(Fe,Fe.indexOf(e)),Fe.length===0&&(document.removeEventListener("paste",zr),wt=!1)},Ho=function(){var e=function(n){t.onload(n)},t={destroy:function(){Yo(e)},onload:function(){}};return xo(e),t},Wo=function(e){var t=e.root,r=e.props;t.element.id="filepond--assistant-"+r.id,k(t.element,"role","status"),k(t.element,"aria-live","polite"),k(t.element,"aria-relevant","additions")},Xr=null,$r=null,Nt=[],ot=function(e,t){e.element.textContent=t},jo=function(e){e.element.textContent=""},Qr=function(e,t,r){var n=e.query("GET_TOTAL_ITEMS");ot(e,r+" "+t+", "+n+" "+(n===1?e.query("GET_LABEL_FILE_COUNT_SINGULAR"):e.query("GET_LABEL_FILE_COUNT_PLURAL"))),clearTimeout($r),$r=setTimeout(function(){jo(e)},1500)},kr=function(e){return e.element.parentNode.contains(document.activeElement)},zo=function(e){var t=e.root,r=e.action;if(kr(t)){t.element.textContent="";var n=t.query("GET_ITEM",r.id);Nt.push(n.filename),clearTimeout(Xr),Xr=setTimeout(function(){Qr(t,Nt.join(", "),t.query("GET_LABEL_FILE_ADDED")),Nt.length=0},750)}},Xo=function(e){var t=e.root,r=e.action;if(kr(t)){var n=r.item;Qr(t,n.filename,t.query("GET_LABEL_FILE_REMOVED"))}},$o=function(e){var t=e.root,r=e.action,n=t.query("GET_ITEM",r.id),i=n.filename,o=t.query("GET_LABEL_FILE_PROCESSING_COMPLETE");ot(t,i+" "+o)},Kr=function(e){var t=e.root,r=e.action,n=t.query("GET_ITEM",r.id),i=n.filename,o=t.query("GET_LABEL_FILE_PROCESSING_ABORTED");ot(t,i+" "+o)},st=function(e){var t=e.root,r=e.action,n=t.query("GET_ITEM",r.id),i=n.filename;ot(t,r.status.main+" "+i+" "+r.status.sub)},Qo=K({create:Wo,ignoreRect:!0,ignoreRectUpdate:!0,write:te({DID_LOAD_ITEM:zo,DID_REMOVE_ITEM:Xo,DID_COMPLETE_ITEM_PROCESSING:$o,DID_ABORT_ITEM_PROCESSING:Kr,DID_REVERT_ITEM_PROCESSING:Kr,DID_THROW_ITEM_REMOVE_ERROR:st,DID_THROW_ITEM_LOAD_ERROR:st,DID_THROW_ITEM_INVALID:st,DID_THROW_ITEM_PROCESSING_ERROR:st}),tag:"span",name:"assistant"}),Zr=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"-";return e.replace(new RegExp(t+".","g"),function(r){return r.charAt(1).toUpperCase()})},Jr=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=Date.now(),i=null;return function(){for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];clearTimeout(i);var l=Date.now()-n,c=function(){n=Date.now(),e.apply(void 0,s)};l<t?r||(i=setTimeout(c,t-l)):c()}},ko=1e6,ut=function(e){return e.preventDefault()},Ko=function(e){var t=e.root,r=e.props,n=t.query("GET_ID");n&&(t.element.id=n);var i=t.query("GET_CLASS_NAME");i&&i.split(" ").filter(function(d){return d.length}).forEach(function(d){t.element.classList.add(d)}),t.ref.label=t.appendChildView(t.createChildView(Ja,Object.assign({},r,{translateY:null,caption:t.query("GET_LABEL_IDLE")}))),t.ref.list=t.appendChildView(t.createChildView(Xa,{translateY:null})),t.ref.panel=t.appendChildView(t.createChildView(Pr,{name:"panel-root"})),t.ref.assistant=t.appendChildView(t.createChildView(Qo,Object.assign({},r))),t.ref.data=t.appendChildView(t.createChildView(mo,Object.assign({},r))),t.ref.measure=pe("div"),t.ref.measure.style.height="100%",t.element.appendChild(t.ref.measure),t.ref.bounds=null,t.query("GET_STYLES").filter(function(d){return!ve(d.value)}).map(function(d){var f=d.name,E=d.value;t.element.dataset[f]=E}),t.ref.widthPrevious=null,t.ref.widthUpdated=Jr(function(){t.ref.updateHistory=[],t.dispatch("DID_RESIZE_ROOT")},250),t.ref.previousAspectRatio=null,t.ref.updateHistory=[];var o=window.matchMedia("(pointer: fine) and (hover: hover)").matches,s="PointerEvent"in window;t.query("GET_ALLOW_REORDER")&&s&&!o&&(t.element.addEventListener("touchmove",ut,{passive:!1}),t.element.addEventListener("gesturestart",ut));var u=t.query("GET_CREDITS"),l=u.length===2;if(l){var c=document.createElement("a");c.className="filepond--credits",c.setAttribute("aria-hidden","true"),c.href=u[0],c.tabindex=-1,c.target="_blank",c.rel="noopener noreferrer",c.textContent=u[1],t.element.appendChild(c),t.ref.credits=c}},Zo=function(e){var t=e.root,r=e.props,n=e.actions;if(ns({root:t,props:r,actions:n}),n.filter(function(U){return/^DID_SET_STYLE_/.test(U.type)}).filter(function(U){return!ve(U.data.value)}).map(function(U){var x=U.type,Ge=U.data,He=Zr(x.substring(8).toLowerCase(),"_");t.element.dataset[He]=Ge.value,t.invalidateLayout()}),!t.rect.element.hidden){t.rect.element.width!==t.ref.widthPrevious&&(t.ref.widthPrevious=t.rect.element.width,t.ref.widthUpdated());var i=t.ref.bounds;i||(i=t.ref.bounds=ts(t),t.element.removeChild(t.ref.measure),t.ref.measure=null);var o=t.ref,s=o.hopper,u=o.label,l=o.list,c=o.panel;s&&s.updateHopperState();var d=t.query("GET_PANEL_ASPECT_RATIO"),f=t.query("GET_ALLOW_MULTIPLE"),E=t.query("GET_TOTAL_ITEMS"),I=f?t.query("GET_MAX_FILES")||ko:1,T=E===I,p=n.find(function(U){return U.type==="DID_ADD_ITEM"});if(T&&p){var _=p.data.interactionMethod;u.opacity=0,f?u.translateY=-40:_===oe.API?u.translateX=40:_===oe.BROWSE?u.translateY=40:u.translateY=30}else T||(u.opacity=1,u.translateX=0,u.translateY=0);var S=Jo(t),P=es(t),R=u.rect.element.height,F=!f||T?0:R,h=T?l.rect.element.marginTop:0,H=E===0?0:l.rect.element.marginBottom,W=F+h+P.visual+H,D=F+h+P.bounds+H;if(l.translateY=Math.max(0,F-l.rect.element.marginTop)-S.top,d){var b=t.rect.element.width,L=b*d;d!==t.ref.previousAspectRatio&&(t.ref.previousAspectRatio=d,t.ref.updateHistory=[]);var O=t.ref.updateHistory;O.push(b);var A=2;if(O.length>A*2){for(var M=O.length,j=M-10,Y=0,C=M;C>=j;C--)if(O[C]===O[C-2]&&Y++,Y>=A)return}c.scalable=!1,c.height=L;var m=L-F-(H-S.bottom)-(T?h:0);P.visual>m?l.overflow=m:l.overflow=null,t.height=L}else if(i.fixedHeight){c.scalable=!1;var v=i.fixedHeight-F-(H-S.bottom)-(T?h:0);P.visual>v?l.overflow=v:l.overflow=null}else if(i.cappedHeight){var y=W>=i.cappedHeight,w=Math.min(i.cappedHeight,W);c.scalable=!0,c.height=y?w:w-S.top-S.bottom;var G=w-F-(H-S.bottom)-(T?h:0);W>i.cappedHeight&&P.visual>G?l.overflow=G:l.overflow=null,t.height=Math.min(i.cappedHeight,D-S.top-S.bottom)}else{var V=E>0?S.top+S.bottom:0;c.scalable=!0,c.height=Math.max(R,W-V),t.height=Math.max(R,D-V)}t.ref.credits&&c.heightCurrent&&(t.ref.credits.style.transform="translateY("+c.heightCurrent+"px)")}},Jo=function(e){var t=e.ref.list.childViews[0].childViews[0];return t?{top:t.rect.element.marginTop,bottom:t.rect.element.marginBottom}:{top:0,bottom:0}},es=function(e){var t=0,r=0,n=e.ref.list,i=n.childViews[0],o=i.childViews.filter(function(P){return P.rect.element.height}),s=e.query("GET_ACTIVE_ITEMS").map(function(P){return o.find(function(R){return R.id===P.id})}).filter(function(P){return P});if(s.length===0)return{visual:t,bounds:r};var u=i.rect.element.width,l=At(i,s,n.dragCoordinates),c=s[0].rect.element,d=c.marginTop+c.marginBottom,f=c.marginLeft+c.marginRight,E=c.width+f,I=c.height+d,T=typeof l<"u"&&l>=0?1:0,p=s.find(function(P){return P.markedForRemoval&&P.opacity<.45})?-1:0,_=s.length+T+p,S=St(u,E);return S===1?s.forEach(function(P){var R=P.rect.element.height+d;r+=R,t+=R*P.opacity}):(r=Math.ceil(_/S)*I,t=r),{visual:t,bounds:r}},ts=function(e){var t=e.ref.measureHeight||null,r=parseInt(e.style.maxHeight,10)||null,n=t===0?null:t;return{cappedHeight:r,fixedHeight:n}},Ft=function(e,t){var r=e.query("GET_ALLOW_REPLACE"),n=e.query("GET_ALLOW_MULTIPLE"),i=e.query("GET_TOTAL_ITEMS"),o=e.query("GET_MAX_FILES"),s=t.length;if(!n&&s>1)return e.dispatch("DID_THROW_MAX_FILES",{source:t,error:$("warning",0,"Max files")}),!0;if(o=n?o:1,!n&&r)return!1;var u=be(o);return u&&i+s>o?(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:$("warning",0,"Max files")}),!0):!1},rs=function(e,t,r){var n=e.childViews[0];return At(n,t,{left:r.scopeLeft-n.rect.element.left,top:r.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},en=function(e){var t=e.query("GET_ALLOW_DROP"),r=e.query("GET_DISABLED"),n=t&&!r;if(n&&!e.ref.hopper){var i=qo(e.element,function(o){var s=e.query("GET_BEFORE_DROP_FILE")||function(){return!0},u=e.query("GET_DROP_VALIDATION");return u?o.every(function(l){return he("ALLOW_HOPPER_ITEM",l,{query:e.query}).every(function(c){return c===!0})&&s(l)}):!0},{filterItems:function(s){var u=e.query("GET_IGNORED_FILES");return s.filter(function(l){return we(l)?!u.includes(l.name.toLowerCase()):!0})},catchesDropsOnPage:e.query("GET_DROP_ON_PAGE"),requiresDropOnElement:e.query("GET_DROP_ON_ELEMENT")});i.onload=function(o,s){var u=e.ref.list.childViews[0],l=u.childViews.filter(function(d){return d.rect.element.height}),c=e.query("GET_ACTIVE_ITEMS").map(function(d){return l.find(function(f){return f.id===d.id})}).filter(function(d){return d});le("ADD_ITEMS",o,{dispatch:e.dispatch}).then(function(d){if(Ft(e,d))return!1;e.dispatch("ADD_ITEMS",{items:d,index:rs(e.ref.list,c,s),interactionMethod:oe.DROP})}),e.dispatch("DID_DROP",{position:s}),e.dispatch("DID_END_DRAG",{position:s})},i.ondragstart=function(o){e.dispatch("DID_START_DRAG",{position:o})},i.ondrag=Jr(function(o){e.dispatch("DID_DRAG",{position:o})}),i.ondragend=function(o){e.dispatch("DID_END_DRAG",{position:o})},e.ref.hopper=i,e.ref.drip=e.appendChildView(e.createChildView(so))}else!n&&e.ref.hopper&&(e.ref.hopper.destroy(),e.ref.hopper=null,e.removeChildView(e.ref.drip))},tn=function(e,t){var r=e.query("GET_ALLOW_BROWSE"),n=e.query("GET_DISABLED"),i=r&&!n;i&&!e.ref.browser?e.ref.browser=e.appendChildView(e.createChildView(Ka,Object.assign({},t,{onload:function(s){le("ADD_ITEMS",s,{dispatch:e.dispatch}).then(function(u){if(Ft(e,u))return!1;e.dispatch("ADD_ITEMS",{items:u,index:-1,interactionMethod:oe.BROWSE})})}})),0):!i&&e.ref.browser&&(e.removeChildView(e.ref.browser),e.ref.browser=null)},rn=function(e){var t=e.query("GET_ALLOW_PASTE"),r=e.query("GET_DISABLED"),n=t&&!r;n&&!e.ref.paster?(e.ref.paster=Ho(),e.ref.paster.onload=function(i){le("ADD_ITEMS",i,{dispatch:e.dispatch}).then(function(o){if(Ft(e,o))return!1;e.dispatch("ADD_ITEMS",{items:o,index:-1,interactionMethod:oe.PASTE})})}):!n&&e.ref.paster&&(e.ref.paster.destroy(),e.ref.paster=null)},ns=te({DID_SET_ALLOW_BROWSE:function(e){var t=e.root,r=e.props;tn(t,r)},DID_SET_ALLOW_DROP:function(e){var t=e.root;en(t)},DID_SET_ALLOW_PASTE:function(e){var t=e.root;rn(t)},DID_SET_DISABLED:function(e){var t=e.root,r=e.props;en(t),rn(t),tn(t,r);var n=t.query("GET_DISABLED");n?t.element.dataset.disabled="disabled":t.element.removeAttribute("data-disabled")}}),is=K({name:"root",read:function(e){var t=e.root;t.ref.measure&&(t.ref.measureHeight=t.ref.measure.offsetHeight)},create:Ko,write:Zo,destroy:function(e){var t=e.root;t.ref.paster&&t.ref.paster.destroy(),t.ref.hopper&&t.ref.hopper.destroy(),t.element.removeEventListener("touchmove",ut),t.element.removeEventListener("gesturestart",ut)},mixins:{styles:["height"]}}),as=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=null,r=Ke(),n=En(ei(r),[Oi,ni(r)],[Qi,ri(r)]);n.dispatch("SET_OPTIONS",{options:e});var i=function(){document.hidden||n.dispatch("KICK")};document.addEventListener("visibilitychange",i);var o=null,s=!1,u=!1,l=null,c=null,d=function(){s||(s=!0),clearTimeout(o),o=setTimeout(function(){s=!1,l=null,c=null,u&&(u=!1,n.dispatch("DID_STOP_RESIZE"))},500)};window.addEventListener("resize",d);var f=is(n,{id:ft()}),E=!1,I=!1,T={_read:function(){s&&(c=window.innerWidth,l||(l=c),!u&&c!==l&&(n.dispatch("DID_START_RESIZE"),u=!0)),I&&E&&(E=f.element.offsetParent===null),!E&&(f._read(),I=f.rect.element.hidden)},_write:function(m){var v=n.processActionQueue().filter(function(y){return!/^SET_/.test(y.type)});E&&!v.length||(P(v),E=f._write(m,v,u),fi(n.query("GET_ITEMS")),E&&n.processDispatchQueue())}},p=function(m){return function(v){var y={type:m};if(!v)return y;if(v.hasOwnProperty("error")&&(y.error=v.error?Object.assign({},v.error):null),v.status&&(y.status=Object.assign({},v.status)),v.file&&(y.output=v.file),v.source)y.file=v.source;else if(v.item||v.id){var w=v.item?v.item:n.query("GET_ITEM",v.id);y.file=w?ne(w):null}return v.items&&(y.items=v.items.map(ne)),/progress/.test(m)&&(y.progress=v.progress),v.hasOwnProperty("origin")&&v.hasOwnProperty("target")&&(y.origin=v.origin,y.target=v.target),y}},_={DID_DESTROY:p("destroy"),DID_INIT:p("init"),DID_THROW_MAX_FILES:p("warning"),DID_INIT_ITEM:p("initfile"),DID_START_ITEM_LOAD:p("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:p("addfileprogress"),DID_LOAD_ITEM:p("addfile"),DID_THROW_ITEM_INVALID:[p("error"),p("addfile")],DID_THROW_ITEM_LOAD_ERROR:[p("error"),p("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[p("error"),p("removefile")],DID_PREPARE_OUTPUT:p("preparefile"),DID_START_ITEM_PROCESSING:p("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:p("processfileprogress"),DID_ABORT_ITEM_PROCESSING:p("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:p("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:p("processfiles"),DID_REVERT_ITEM_PROCESSING:p("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[p("error"),p("processfile")],DID_REMOVE_ITEM:p("removefile"),DID_UPDATE_ITEMS:p("updatefiles"),DID_ACTIVATE_ITEM:p("activatefile"),DID_REORDER_ITEMS:p("reorderfiles")},S=function(m){var v=Object.assign({pond:Y},m);delete v.type,f.element.dispatchEvent(new CustomEvent("FilePond:"+m.type,{detail:v,bubbles:!0,cancelable:!0,composed:!0}));var y=[];m.hasOwnProperty("error")&&y.push(m.error),m.hasOwnProperty("file")&&y.push(m.file);var w=["type","error","file"];Object.keys(m).filter(function(V){return!w.includes(V)}).forEach(function(V){return y.push(m[V])}),Y.fire.apply(Y,[m.type].concat(y));var G=n.query("GET_ON"+m.type.toUpperCase());G&&G.apply(void 0,y)},P=function(m){m.length&&m.filter(function(v){return _[v.type]}).forEach(function(v){var y=_[v.type];(Array.isArray(y)?y:[y]).forEach(function(w){v.type==="DID_INIT_ITEM"?S(w(v.data)):setTimeout(function(){S(w(v.data))},0)})})},R=function(m){return n.dispatch("SET_OPTIONS",{options:m})},F=function(m){return n.query("GET_ACTIVE_ITEM",m)},h=function(m){return new Promise(function(v,y){n.dispatch("REQUEST_ITEM_PREPARE",{query:m,success:function(G){v(G)},failure:function(G){y(G)}})})},H=function(m){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(y,w){b([{source:m,options:v}],{index:v.index}).then(function(G){return y(G&&G[0])}).catch(w)})},W=function(m){return m.file&&m.id},D=function(m,v){return typeof m=="object"&&!W(m)&&!v&&(v=m,m=void 0),n.dispatch("REMOVE_ITEM",Object.assign({},v,{query:m})),n.query("GET_ACTIVE_ITEM",m)===null},b=function(){for(var m=arguments.length,v=new Array(m),y=0;y<m;y++)v[y]=arguments[y];return new Promise(function(w,G){var V=[],U={};if(je(v[0]))V.push.apply(V,v[0]),Object.assign(U,v[1]||{});else{var x=v[v.length-1];typeof x=="object"&&!(x instanceof Blob)&&Object.assign(U,v.pop()),V.push.apply(V,v)}n.dispatch("ADD_ITEMS",{items:V,index:U.index,interactionMethod:oe.API,success:w,failure:G})})},L=function(){return n.query("GET_ACTIVE_ITEMS")},O=function(m){return new Promise(function(v,y){n.dispatch("REQUEST_ITEM_PROCESSING",{query:m,success:function(G){v(G)},failure:function(G){y(G)}})})},A=function(){for(var m=arguments.length,v=new Array(m),y=0;y<m;y++)v[y]=arguments[y];var w=Array.isArray(v[0])?v[0]:v,G=w.length?w:L();return Promise.all(G.map(h))},M=function(){for(var m=arguments.length,v=new Array(m),y=0;y<m;y++)v[y]=arguments[y];var w=Array.isArray(v[0])?v[0]:v;if(!w.length){var G=L().filter(function(V){return!(V.status===N.IDLE&&V.origin===Z.LOCAL)&&V.status!==N.PROCESSING&&V.status!==N.PROCESSING_COMPLETE&&V.status!==N.PROCESSING_REVERT_ERROR});return Promise.all(G.map(O))}return Promise.all(w.map(O))},j=function(){for(var m=arguments.length,v=new Array(m),y=0;y<m;y++)v[y]=arguments[y];var w=Array.isArray(v[0])?v[0]:v,G;typeof w[w.length-1]=="object"?G=w.pop():Array.isArray(v[0])&&(G=v[1]);var V=L();if(!w.length)return Promise.all(V.map(function(x){return D(x,G)}));var U=w.map(function(x){return _e(x)?V[x]?V[x].id:null:x}).filter(function(x){return x});return U.map(function(x){return D(x,G)})},Y=Object.assign({},ke(),{},T,{},ti(n,r),{setOptions:R,addFile:H,addFiles:b,getFile:F,processFile:O,prepareFile:h,removeFile:D,moveFile:function(m,v){return n.dispatch("MOVE_ITEM",{query:m,index:v})},getFiles:L,processFiles:M,removeFiles:j,prepareFiles:A,sort:function(m){return n.dispatch("SORT",{compare:m})},browse:function(){var m=f.element.querySelector("input[type=file]");m&&m.click()},destroy:function(){Y.fire("destroy",f.element),n.dispatch("ABORT_ALL"),f._destroy(),window.removeEventListener("resize",d),document.removeEventListener("visibilitychange",i),n.dispatch("DID_DESTROY")},insertBefore:function(m){return jt(f.element,m)},insertAfter:function(m){return zt(f.element,m)},appendTo:function(m){return m.appendChild(f.element)},replaceElement:function(m){jt(f.element,m),m.parentNode.removeChild(m),t=m},restoreElement:function(){t&&(zt(t,f.element),f.element.parentNode.removeChild(f.element),t=null)},isAttachedTo:function(m){return f.element===m||t===m},element:{get:function(){return f.element}},status:{get:function(){return n.query("GET_STATUS")}}});return n.dispatch("DID_INIT"),me(Y)},nn=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={};X(Ke(),function(n,i){t[n]=i[0]});var r=as(Object.assign({},t,{},e));return r},os=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},ss=function(e){return Zr(e.replace(/^data-/,""))},us=function a(e,t){X(t,function(r,n){X(e,function(i,o){var s=new RegExp(r),u=s.test(i);if(u&&(delete e[i],n!==!1)){if(re(n)){e[n]=o;return}var l=n.group;J(n)&&!e[l]&&(e[l]={}),e[l][os(i.replace(s,""))]=o}}),n.mapping&&a(e[n.group],n.mapping)})},ls=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[];X(e.attributes,function(i){r.push(e.attributes[i])});var n=r.filter(function(i){return i.name}).reduce(function(i,o){var s=k(e,o.name);return i[ss(o.name)]=s===o.name?!0:s,i},{});return us(n,t),n},cs=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};he("SET_ATTRIBUTE_TO_OPTION_MAP",r);var n=Object.assign({},t),i=ls(e.nodeName==="FIELDSET"?e.querySelector("input[type=file]"):e,r);Object.keys(i).forEach(function(s){J(i[s])?(J(n[s])||(n[s]={}),Object.assign(n[s],i[s])):n[s]=i[s]}),n.files=(t.files||[]).concat(Array.from(e.querySelectorAll("input:not([type=file])")).map(function(s){return{source:s.value,options:{type:s.dataset.type}}}));var o=nn(n);return e.files&&Array.from(e.files).forEach(function(s){o.addFile(s)}),o.replaceElement(e),o},fs=function(){return de(arguments.length<=0?void 0:arguments[0])?cs.apply(void 0,arguments):nn.apply(void 0,arguments)},ds=["fire","_read","_write"],an=function(e){var t={};return er(e,t,ds),t},vs=function(e,t){return e.replace(/(?:{([a-zA-Z]+)})/g,function(r,n){return t[n]})},ps=function(e){var t=new Blob(["(",e.toString(),")()"],{type:"application/javascript"}),r=URL.createObjectURL(t),n=new Worker(r);return{transfer:function(o,s){},post:function(o,s,u){var l=ft();n.onmessage=function(c){c.data.id===l&&s(c.data.message)},n.postMessage({id:l,message:o},u)},terminate:function(){n.terminate(),URL.revokeObjectURL(r)}}},Es=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){t(n)},n.onerror=function(i){r(i)},n.src=e})},on=function(e,t){var r=e.slice(0,e.size,e.type);return r.lastModifiedDate=e.lastModifiedDate,r.name=t,r},gs=function(e){return on(e,e.name)},sn=[],ms=function(e){if(!sn.includes(e)){sn.push(e);var t=e({addFilter:vi,utils:{Type:g,forin:X,isString:re,isFile:we,toNaturalFileSize:_r,replaceInString:vs,getExtensionFromFilename:Je,getFilenameWithoutExtension:dr,guesstimateMimeType:Hr,getFileFromBlob:Ce,getFilenameFromURL:Ue,createRoute:te,createWorker:ps,createView:K,createItemAPI:ne,loadImage:Es,copyFile:gs,renameFile:on,createBlob:sr,applyFilterChain:le,text:Q,getNumericAspectRatioFromString:nr},views:{fileActionButton:Tr}});pi(t.options)}},Is=function(){return Object.prototype.toString.call(window.operamini)==="[object OperaMini]"},Ts=function(){return"Promise"in window},_s=function(){return"slice"in Blob.prototype},Rs=function(){return"URL"in window&&"createObjectURL"in window.URL},hs=function(){return"visibilityState"in document},Os=function(){return"performance"in window},Ds=function(){return"supports"in(window.CSS||{})},Ss=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},Gt=function(){var a=Vt()&&!Is()&&hs()&&Ts()&&_s()&&Rs()&&Os()&&(Ds()||Ss());return function(){return a}}(),Ie={apps:[]},As="filepond",ye=function(){};if(B.Status={},B.FileStatus={},B.FileOrigin={},B.OptionTypes={},B.create=ye,B.destroy=ye,B.parse=ye,B.find=ye,B.registerPlugin=ye,B.getOptions=ye,B.setOptions=ye,Gt()){qn(function(){Ie.apps.forEach(function(a){return a._read()})},function(a){Ie.apps.forEach(function(e){return e._write(a)})});var un=function a(){document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:Gt,create:B.create,destroy:B.destroy,parse:B.parse,find:B.find,registerPlugin:B.registerPlugin,setOptions:B.setOptions}})),document.removeEventListener("DOMContentLoaded",a)};document.readyState!=="loading"?setTimeout(function(){return un()},0):document.addEventListener("DOMContentLoaded",un);var ln=function(){return X(Ke(),function(e,t){B.OptionTypes[e]=t[1]})};B.Status=Object.assign({},Me),B.FileOrigin=Object.assign({},Z),B.FileStatus=Object.assign({},N),B.OptionTypes={},ln(),B.create=function(){var e=fs.apply(void 0,arguments);return e.on("destroy",B.destroy),Ie.apps.push(e),an(e)},B.destroy=function(e){var t=Ie.apps.findIndex(function(n){return n.isAttachedTo(e)});if(t>=0){var r=Ie.apps.splice(t,1)[0];return r.restoreElement(),!0}return!1},B.parse=function(e){var t=Array.from(e.querySelectorAll("."+As)),r=t.filter(function(n){return!Ie.apps.find(function(i){return i.isAttachedTo(n)})});return r.map(function(n){return B.create(n)})},B.find=function(e){var t=Ie.apps.find(function(r){return r.isAttachedTo(e)});return t?an(t):null},B.registerPlugin=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(ms),ln()},B.getOptions=function(){var e={};return X(Ke(),function(t,r){e[t]=r[0]}),e},B.setOptions=function(e){return J(e)&&(Ie.apps.forEach(function(t){t.setOptions(e)}),Ei(e)),B.getOptions()}}B.supported=Gt,Object.defineProperty(B,"__esModule",{value:!0})})});export default Gs();
